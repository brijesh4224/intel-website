<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fast RNG with Sub-Stream Parallelization</title>

    <link rel="stylesheet" href="/css/dk_developer_edge_iot_&_5G_social_distancing_for_retail_settings.css">

    <!-- header footer -->
    <link rel="stylesheet" href='/css/yatri.css'>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
        crossorigin="anonymous"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" rel="stylesheet">
</head>

<style>
    .dk_oneapi_deco{
        color: #0068b5;
        font-weight: bold;
    }
    .dk_oneapi_deco:hover{
        text-decoration: underline;
    }
    @media (max-width: 767px){
    .dk_designed_oneapi{
        flex-wrap: wrap-reverse !important;
    }
    .dk_designed_oneapi img{
        margin-bottom: 2rem;
        }   
    }
    .dk_overview_api{
        word-wrap: break-word;
        background-color: #e6e6e6;
        padding: 20px;
        border-left: 3px solid #fdb813;
    }
    .dk_overview_api p{
        font-weight: bold;
    }
    .dk_overview_api_sub{
        color: blue;
        text-decoration: underline !important;
        font-weight: 700;
    }
    .dk_overview_api_sub:hover{
        color: blue;
    }
    .dk_overview_api_sub2{
        color: blue;
        text-decoration: underline !important;
        font-weight: 400;
    }
    .dk_overview_api_sub2:hover{
        color: blue;
    }
</style>

<body>

    <!-- header -->
    <div id="navbar"></div>

    <!-- Social Distancing for Retail Settings -->
    <section>
        <div class="mv_intel_amx_bg_color">
            <div class="container">
                <div class="row mv_intel_amx_content">
                    <div class="col-md-12 col-sm-12 mv_intel_amx_item">
                        <div class="mv_intel_amx">
                            <h1 style="font-weight: 300; font-size: 2.25rem;">Fast Sub-Stream Parallelization for oneMKL MRG32k3a Random Number Generator</h1>
                            <p>October 30, 2024</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section class="container py-5">
        <div class="row">
            <div class="d-flex justify-content-end col-xl-10 py-3 d-md-none">
                <i class="fa-solid fa-print fs-4 px-2 " style="color:#0068B5"></i>
                <i class="fa-regular fa-envelope fs-4 px-2" style="color:#0068B5"></i>
            </div>
            <div class="col-lg-3 col-md-4">
                <!-- nav -->
                <div class="VK_sticky_side_bar VK_side_bar_postion_stickey">
                    <div>
                        <div class="VK_sidebar_dropdown">
                            <p class="m-0">
                                <a href="#dk_random_number" class="text-decoration-none VK_a">
                                    Random Number Generation and Parallel Compute  
                                </a>
                            </p>
                            <p class="m-0">
                                <a href="#dk_parallelization_app" class="text-decoration-none VK_a">
                                    Parallelization Approaches
                                </a>
                            </p>
                            <p class="m-0">
                                <a href="#dk_usage_of_sub" class="text-decoration-none VK_a">
                                    Usage of Sub-Sequences with oneMKL
                                </a>
                            </p>
                            <p class="m-0">
                                <a href="#dk_curand_and_onemkl" class="text-decoration-none VK_a">
                                    CuRAND and oneMKL RNG Interchangeability.
                                </a>
                            </p>
                            <p class="m-0">
                                <a href="#dk_scalability_pre" class="text-decoration-none VK_a">
                                    Scalability while Preserving Randomness
                                </a>
                            </p>
                            <p class="m-0">
                                <a href="#dk_get_the_software" class="text-decoration-none VK_a">
                                    Get the Software
                                </a>
                            </p>
                            <p class="m-0">
                                <a href="#dk_additional_res" class="text-decoration-none VK_a">
                                    Additional Resources
                                </a>
                            </p>
                            <p class="m-0">
                                <a href="#dk_references" class="text-decoration-none VK_a">
                                    References
                                </a>
                            </p>
                        </div>
                    </div>
                </div>
                <!-- thinkcode -->
                <div class="dk_things_code_main">
                    <div class="dk_things_code">
                        <h2 class="text-left headline-font-one-bold mb-4">Get the Latest on All Things CODE</h2>
                        <a class="dk_button" href="">Sign Up</a>
                        <p class="mb-0">&nbsp;</p>
                    </div> 
                </div>
                <p class="dk_oneapi_deco mb-2">Ivan Martyanov,</p>
                <p class="mb-2">Math Algorithm Software Developer</p>
                <p class="dk_oneapi_deco mb-2">Andrey Fedorov,</p>
                <p class="mb-2">Math Algorithm Software Developer</p>
                <p class="dk_oneapi_deco mb-2">Robert Mueller-Albrecht,</p>
                <p class="mb-2">Product Marketing Engineer</p>
                <p class="mb-0">&nbsp;</p>
                <p class="mb-0">Intel Corporation</p>
            </div>
            <div class="col-lg-9 col-md-8">
                <div class="d-md-flex justify-content-end col-xl-10 py-3 d-none">
                    <i class="fa-solid fa-print fs-4 px-2 " style="color:#0068B5"></i>
                    <i class="fa-regular fa-envelope fs-4 px-2" style="color:#0068B5"></i>
                </div>
                <div class="col-xl-10 VK_all_sections">
                    <section id="dk_random_number">
                        <p class="mb-0">&nbsp;</p>
                        <p class="mb-0">&nbsp;</p>
                        <p class="mb-0">&nbsp;</p>

                            <h3 style="font-weight: 300;">Random Number Generation and Parallel Compute<a class="" id=""></a></h3>
                        <p style="text-align:justify">GPUs&nbsp;have become increasingly powerful and are widely used for various computational tasks, including random number generation. Random numbers are essential in many applications, such as cryptography, simulation, and scientific computing. They play a key role in providing the random seeds for many different prediction scenarios from predictive maintenance, quantitative finance risk assessment, or earthquake and tsunami emergency response planning. &nbsp;GPUs offer a significant advantage in generating random numbers due to their parallel processing capabilities. This allows for generating many random numbers simultaneously, improving efficiency and speed. In the digital age, where data privacy and accuracy are paramount, generating random numbers on GPU is vital in scaling and accelerating highly accurate calculations, simulations, and prediction engines. It makes highly secure cryptography in banking, health sciences, and corporate security possible without impacting the end-user experience.</p>

                        <p style="text-align:justify">The <a href="" style="color:#467886; text-decoration:underline !important">Intel® oneAPI Math Kernel Library</a> (oneMKL) is a high-performance math library that provides optimized functions for mathematical computations. It is designed to accelerate complex mathematical operations, such as linear algebra, fast Fourier transforms, and random number generation. oneMKL is part of the Intel® oneAPI Base Toolkit, a comprehensive set of development tools and libraries for building optimized high-performance applications targeting accelerated compute platforms.</p>

                        <p style="text-align:justify">The MRG32k3a<sup>[1]</sup> random number generator is a widely used algorithm for generating pseudo-random numbers for these more advanced use cases. It is a combined multiple recursive random number generator with a long period. Thus, it can produce a large set of unique random numbers before repeating. It is known for its good statistical properties, making it suitable for many different applications.</p>

                        <p style="text-align:justify">What if we can improve its performance even more by splitting the algorithm into several smaller tasks that can be processed simultaneously? We aim to increase performance by increasing the algorithm's parallelism level. &nbsp;</p>

                        <p style="text-align:justify">In this article, we introduce the addition of a sub-sequence parallelization method for MRG32k3a random number generator to oneMKL. While there are already existing methods for generating random numbers in the library, this article highlights the benefits of incorporating a sub-sequence parallelization technique.</p>

                    </section>

                    <p class="">&nbsp;</p>

                    <section id="dk_parallelization_app">
                        <h3 style="font-weight: 300;">Parallelization Approaches</h3>
                        <p style="text-align:justify">There are various ways to generate random numbers in parallel. However, we need to consider the statistical correctness of the resulting sequence and generator period. The statistical randomness and the length of the&nbsp;period before a number repeats cannot be compromised. The following section explores the primary strategies for implementing such parallelization.</p>
                        <p style="text-align:justify">The standard implementation of MRG32k3a random number parallelization involves dividing the generation process equally among threads using the <a href="" style="color:#467886; text-decoration:underline !important">skip ahead</a><sup>[2]</sup> method (Figure 1). For instance, if we generate 100 random numbers with 10 threads, the first thread will generate the first 10 elements, the second thread will generate the next 10 elements, and so on. While this approach ensures consistent output, it also requires a highly computationally complex skip-ahead operation for each thread.</p>
                        <div class="mb-3">
                            <img class="w-100" src="/img/darshit_image/fig1-approaches.png" alt="">
                        </div>
                        <p style="text-align:center"><strong>Figure 1</strong>. Types of Parallelization Approaches</p>
                        <p style="text-align:justify">&nbsp;</p>
                        <p style="text-align:justify">The research outlined in a&nbsp;paper by Pierre L'Ecuyer et al. on “<em>Object-Oriented Random-Number Package with Many Long Streams and Substreams</em>” <sup>[4]</sup> demonstrates that the sequence produced by the MRG32k3a generator can be segmented into sub-sequences with a 2^67 element displacement (Figure1), and these can be recombined without creating any correlation in the resulting sequence.</p>
                        <p style="text-align:justify">This is indeed possible for the MRG32k3a algorithm, as it has a large period of 2<sup>191</sup> elements. Each sub-stream is responsible for generating random numbers, which are then stored in memory with an offset equal to the total number of sub-streams (Figure. 2). For example, if there are 10 sub-streams and we want to generate 100 random numbers, the first sub-stream will generate the 1st, 11th, ... and 91st elements, while the second sub-stream will generate the 2nd, 12th, ... and 92nd elements, and so on.</p>
                        <div class="mb-3">
                            <img class="w-100" src="/img/darshit_image/fig2-distribution.png" alt="">
                        </div>
                        <p style="text-align:center"><strong>Figure 2</strong>. Approach for Generated Number Distribution into Memory.</p>
                        <p style="text-align:center">&nbsp;</p>
                        <p style="text-align:justify">Another popular method for generating random numbers in parallel involves assigning unique seeds to each thread. Although this approach allows to achieve performance scalability, there is no guarantee of statistical independency of the sequences with different seeds. When random numbers are generated using different seeds in parallel, there is a higher chance of generating similar or correlated sequences of numbers.</p>
                        <p style="text-align:justify">The sub-sequence parallelization method uses a single seed for generation, resulting in decent performance and guaranteeing a high-quality output sequence.</p>
                    </section>

                    <p class="">&nbsp;</p>

                    <section id="dk_usage_of_sub">
                    <h3 style="font-weight: 300">Usage of Sub-Sequences with oneMKL</h3>
                    <p style="text-align:justify">You can use sub-sequence parallelization with oneMKL Host API by providing a method at the random number generator initialization stage (see Table 1).</p>

                    <table class="dk_usage_table w-100">
                        <tbody>
                            <tr>
                                <td>
                                    <div class="mv_code_toolbar">
                                        <div class="mv_toolbar_item mv_copy_icon">
                                            <i class="fa-regular fa-copy"></i>
                                        </div>
                                        <div class="mv_copy_message text-end hidden">Copied</div>
                                        <div class="code-content">
                                            <div style="padding-bottom: 0rem !important" class="d-flex mv_pre">
                                                <div style="border-right: 1px solid #ccc" class="pe-3">
                                                    1
                                                </div>
                                                <div class="">
                                                    <div class="mv_code text-break">
                                                        <p class="mb-0"><span class="dk_code_green">// . . .</span></p>
                                                    </div> 
                                                </div>
                                            </div>
                                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                                <div style="border-right: 1px solid #ccc" class="pe-3">
                                                    2
                                                </div>
                                                <div class="">
                                                    <div class="mv_code text-break">
                                                        <p class="mb-0"></p>
                                                    </div>
                                                </div>
                                            </div>
                                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                                <div style="border-right: 1px solid #ccc" class="pe-3">
                                                    3
                                                </div>
                                                <div class="">
                                                    <div class="mv_code text-break">
                                                        <p class="mb-0"> <span>namespace</span>  host_rng <span class="dk_code_org">=</span>  oneapi <span class="dk_code_org">: :</span> mkl <span class="dk_code_org">: :</span> rng ;</p>
                                                    </div>
                                                </div>
                                            </div>
                                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                                <div style="border-right: 1px solid #ccc" class="pe-3">
                                                    4
                                                </div>
                                                <div class="">
                                                    <div class="mv_code text-break">
                                                        <p class="mb-0"> </p>
                                                    </div>
                                                </div>
                                            </div>
                                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                                <div style="border-right: 1px solid #ccc" class="pe-3">
                                                    5
                                                </div>
                                                <div class="">
                                                    <div class="mv_code text-break">
                                                        <p class="mb-0">host_rng <span class="dk_code_org">: :</span> mrg32k3a</p>
                                                    </div>
                                                </div>
                                            </div>
                                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                                <div style="border-right: 1px solid #ccc" class="pe-3">
                                                    6
                                                </div>
                                                <div class="">
                                                    <div class="mv_code text-break">
                                                        <p class="mb-0"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; engine(queue, seed); </p>
                                                    </div>
                                                </div>
                                            </div>
                                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                                <div style="border-right: 1px solid #ccc" class="pe-3">
                                                    7
                                                </div>
                                                <div class="">
                                                    <div class="mv_code text-break">
                                                        <p class="mb-0"> </p>
                                                    </div>
                                                </div>
                                            </div>
                                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                                <div style="border-right: 1px solid #ccc" class="pe-3">
                                                    8
                                                </div>
                                                <div class="">
                                                    <div class="mv_code text-break">
                                                        <p class="mb-0"> </p>
                                                    </div>
                                                </div>
                                            </div>
                                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                                <div style="border-right: 1px solid #ccc" class="pe-3">
                                                    9
                                                </div>
                                                <div class="">
                                                    <div class="mv_code text-break">
                                                        <p class="mb-0"> host_rng <span class="dk_code_org">: :</span> uniform distribution;</p>
                                                    </div>
                                                </div>
                                            </div>
                                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                                <div style="border-right: 1px solid #ccc; padding-right: 7px;" class="">
                                                    10
                                                </div>
                                                <div class="">
                                                    <div class="mv_code text-break">
                                                        <p class="mb-0"></p>
                                                    </div>
                                                </div>
                                            </div>
                                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                                <div style="border-right: 1px solid #ccc; padding-right: 7px;" class="">
                                                    11
                                                </div>
                                                <div class="">
                                                    <div class="mv_code text-break">
                                                        <p class="mb-0"> host_rng <span class="dk_code_org">: :</span>generate(distribution, engine, n, data); </p>
                                                    </div>
                                                </div>
                                            </div>
                                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                                <div style="border-right: 1px solid #ccc; padding-right: 7px;" class="">
                                                    12
                                                </div>
                                                <div class="">
                                                    <div class="mv_code text-break">
                                                        <p class="mb-0"> </p>
                                                    </div>
                                                </div>
                                            </div>
                                            <div style="padding-top: 0rem !important;" class="d-flex mv_pre">
                                                <div style="border-right: 1px solid #ccc; padding-right: 7px;" class="">
                                                    13
                                                </div>
                                                <div class="">
                                                    <div class="mv_code text-break">
                                                        <p class="mb-0"><span class="dk_code_green">// . . .</span> </p>
                                                    </div>
                                                </div>
                                            </div>        
                                        </div>
                                    </div>
                                </td>
                                
                                <td>
                                    <div class="mv_code_toolbar">
                                        <div class="mv_toolbar_item mv_copy_icon">
                                            <i class="fa-regular fa-copy"></i>
                                        </div>
                                        <div class="mv_copy_message text-end hidden">Copied</div>
                                        <div class="code-content">
                                            <div style="padding-bottom: 0rem !important" class="d-flex mv_pre">
                                                <div style="border-right: 1px solid #ccc" class="pe-3">
                                                    1
                                                </div>
                                                <div class="">
                                                    <div class="mv_code text-break">
                                                        <p class="mb-0"><span class="dk_code_green">// . . .</span></p>
                                                    </div> 
                                                </div>
                                            </div>
                                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                                <div style="border-right: 1px solid #ccc" class="pe-3">
                                                    2
                                                </div>
                                                <div class="">
                                                    <div class="mv_code text-break">
                                                        <p class="mb-0"></p>
                                                    </div>
                                                </div>
                                            </div>
                                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                                <div style="border-right: 1px solid #ccc" class="pe-3">
                                                    3
                                                </div>
                                                <div class="">
                                                    <div class="mv_code text-break">
                                                        <p class="mb-0"> <span>namespace</span>  host_rng <span class="dk_code_org">=</span>  oneapi <span class="dk_code_org">: :</span> mkl <span class="dk_code_org">: :</span> rng ;</p>
                                                    </div>
                                                </div>
                                            </div>
                                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                                <div style="border-right: 1px solid #ccc" class="pe-3">
                                                    4
                                                </div>
                                                <div class="">
                                                    <div class="mv_code text-break">
                                                        <p class="mb-0"> </p>
                                                    </div>
                                                </div>
                                            </div>
                                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                                <div style="border-right: 1px solid #ccc" class="pe-3">
                                                    5
                                                </div>
                                                <div class="">
                                                    <div class="mv_code text-break">
                                                        <p class="mb-0">host_rng <span class="dk_code_org">: :</span> mrg32k3a</p>
                                                    </div>
                                                </div>
                                            </div>
                                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                                <div style="border-right: 1px solid #ccc" class="pe-3">
                                                    6
                                                </div>
                                                <div class="">
                                                    <div class="mv_code text-break">
                                                        <p class="mb-0"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; engine(queue, seed); </p>
                                                    </div>
                                                </div>
                                            </div>
                                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                                <div style="border-right: 1px solid #ccc" class="pe-3">
                                                    7
                                                </div>
                                                <div class="">
                                                    <div class="mv_code text-break">
                                                        <p class="mb-0"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; host_rng <span class="dk_code_org">: :</span> mrg32k3a_mode::optimal{}); </p>
                                                    </div>
                                                </div>
                                            </div>
                                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                                <div style="border-right: 1px solid #ccc" class="pe-3">
                                                    8
                                                </div>
                                                <div class="">
                                                    <div class="mv_code text-break">
                                                        <p class="mb-0"> </p>
                                                    </div>
                                                </div>
                                            </div>
                                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                                <div style="border-right: 1px solid #ccc" class="pe-3">
                                                    9
                                                </div>
                                                <div class="">
                                                    <div class="mv_code text-break">
                                                        <p class="mb-0"> host_rng <span class="dk_code_org">: :</span> uniform distribution;</p>
                                                    </div>
                                                </div>
                                            </div>
                                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                                <div style="border-right: 1px solid #ccc; padding-right: 7px;" class="">
                                                    10
                                                </div>
                                                <div class="">
                                                    <div class="mv_code text-break">
                                                        <p class="mb-0"></p>
                                                    </div>
                                                </div>
                                            </div>
                                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                                <div style="border-right: 1px solid #ccc; padding-right: 7px;" class="">
                                                    11
                                                </div>
                                                <div class="">
                                                    <div class="mv_code text-break">
                                                        <p class="mb-0"> host_rng <span class="dk_code_org">: :</span>generate(distribution, engine, n, data); </p>
                                                    </div>
                                                </div>
                                            </div>
                                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                                <div style="border-right: 1px solid #ccc; padding-right: 7px;" class="">
                                                    12
                                                </div>
                                                <div class="">
                                                    <div class="mv_code text-break">
                                                        <p class="mb-0"> </p>
                                                    </div>
                                                </div>
                                            </div>
                                            <div style="padding-top: 0rem !important;" class="d-flex mv_pre">
                                                <div style="border-right: 1px solid #ccc; padding-right: 7px;" class="">
                                                    13
                                                </div>
                                                <div class="">
                                                    <div class="mv_code text-break">
                                                        <p class="mb-0"><span class="dk_code_green">// . . .</span> </p>
                                                    </div>
                                                </div>
                                            </div>   
                                            
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td style="background-color: #F7F7F7;">Generating n random numbers with standard parallelization approach.</td>
                                <td style="background-color: #F7F7F7;">Generating n random numbers with standard parallelization approach.</td>

                            </tr>
                        </tbody>
                    </table>

                    <p class="mt-3"><strong>Table 1.</strong> Updating the Generation Method for Uniformly Distributed Numbers with MRG32k3a.</p>
                    <p style="text-align:justify">To set the default number of sub-streams based on your hardware, pass <em>optimal{}</em>. Use <em>custom{num_streams}</em> option to manually select the optimal number of sub-streams for the specific task.</p>
                    <p style="text-align:justify">The order in which numbers are generated in a sequence with sub-stream parallelization is determined by the number of sub-streams, as shown above. By utilizing the "<em>custom</em>" option, the same result can be achieved&nbsp;when using different hardware and generator implementations.</p>
                    <p style="text-align:justify">It is also possible to generate numbers using the MRG32k3a generator and sub-sequence parallelization using the oneMKL Device API (Figure 3).</p>

                     <!-- code toolbar 3 -->
                     <div class="mv_code_toolbar">
                        <div class="mv_toolbar_item mv_copy_icon">
                            <i class="fa-regular fa-copy"></i>
                        </div>
                        <div class="mv_copy_message text-end hidden">Copied</div>
                        <div class="code-content">
                            <div style="padding-bottom: 0rem !important" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc" class="pe-3">
                                    1
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0"><span class="dk_code_green">// ...</span></p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc" class="pe-3">
                                    2
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0"></p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc" class="pe-3">
                                    3
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0"> <a class="dk_code_blue;" href="">namespace</a> rng_device <a class="dk_code_org" href=""> = </a>  oneapi <a class="dk_code_org" href=""> : : </a>mkl<a class="dk_code_org" href=""> : : </a>rng<a class="dk_code_org" href=""> : : </a>device;</p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc" class="pe-3">
                                    4
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0"> </p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc" class="pe-3">
                                    5
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0"><span class="dk_code_green">// kernel with initialization of generators</span></p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc" class="pe-3">
                                    6
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0"></p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc" class="pe-3">
                                    7
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0">queue.parallel_for({num_streams}, [ <span class="dk_code_org">=</span> ](std <span class="dk_code_org">: :</span> size_t id) {</p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc" class="pe-3">
                                    8
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0"><span class="dk_code_green"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // initialize generators with an offset of 2^67 elements</span></p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc" class="pe-3">
                                    9
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; rng_device <span class="dk_code_org">: :</span> mrg32k3a <span class="dk_code_org"><</span>1<span class="dk_code_org">></span> engine(seed, {0, 4096 <span class="dk_code_org">*</span>  (id <span class="dk_code_org">% </span> num_streams)});</p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc; padding-right: 7px;" class="">
                                    10
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; engine_ptr[id] <span class="dk_code_org"> = </span> engine;</p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc; padding-right: 7px;" class="">
                                    11
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0"> </p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc; padding-right: 7px;" class="">
                                    12
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0">}).wait(); </p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc; padding-right: 7px;" class="">
                                    13
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0"> </p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc; padding-right: 7px;" class="">
                                    14
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0"> <span class="dk_code_green">// generate random numbers</span> </p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc; padding-right: 7px;" class="">
                                    15
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0"></p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc; padding-right: 7px;" class="">
                                    16
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0">queue.parallel_for({num_streams}, [ <span class="dk_code_org">=</span> ](std <span class="dk_code_org">: :</span> size_t id) { </p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc; padding-right: 7px;" class="">
                                    17
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="dk_code_blue">auto</span>  engine <span class="dk_code_org">=</span>  engine_ptr[id]; </p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc; padding-right: 7px;" class="">
                                    18
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; rng_device  <span class="dk_code_org">: :</span> uniform <span class="dk_code_org"><</span>Type<span class="dk_code_org">></span> distr;</p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc; padding-right: 7px;" class="">
                                    19
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0"></p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc; padding-right: 7px;" class="">
                                    20
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; std <span class="dk_code_org">: :</span> <span class="dk_code_blue">uint32_t</span>  count <span class="dk_code_org">=</span><span class="dk_code_blue"> 0</span> ;</p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc; padding-right: 7px;" class="">
                                    21
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0"></p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc; padding-right: 7px;" class="">
                                    22
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="dk_code_blue">while</span> (id <span class="dk_code_org">+</span>  (count <span class="dk_code_org">*</span> num_streams) <span class="dk_code_org"><</span> n) {</p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc; padding-right: 7px;" class="">
                                    23
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="dk_code_blue">auto</span> res <span class="dk_code_org">=</span> rng_device::generate(distr, engine);</p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc; padding-right: 7px;" class="">
                                    24
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  result_ptr[id <span class="dk_code_org">+</span> (count <span class="dk_code_org">*</span> num_streams)] <span class="dk_code_org">=</span> res;</p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc; padding-right: 7px;" class="">
                                    25
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;count <span class="dk_code_org">++ </span>;</p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc; padding-right: 7px;" class="">
                                    26
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc; padding-right: 7px;" class="">
                                    27
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0"></p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc; padding-right: 7px;" class="">
                                    28
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0">} ) .wait () ;</p>
                                    </div> 
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc; padding-right: 7px;" class="">
                                    29
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0"></p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc; padding-right: 7px;" class="">
                                    30
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0"><span class="dk_code_green">// . . .</span></p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <p><strong>Figure 3.</strong> Example of sub-stream parallelization implementation using oneMKL Device API.</p> 
                    </section>
                    <p class="mb-0">&nbsp;</p>

                    <section id="dk_curand_and_onemkl">
                        <h3 style="font-weight: 300;">CuRAND and oneMKL RNG Interchangeability.</h3>
                        <p class="mt-3" style="text-align:justify">When transitioning an application from the current* (CUDA Random Number Generation) library to oneMKL, it is crucial to preserve the output sequence. Otherwise, the functionality might not be fully identical. This concern is addressed by using sub-sequence parallelization mode with oneMKL’s&nbsp; MRG32k3a random number generator.</p>
                        <p style="text-align:justify">In the cuRAND Host API, the MRG32k3a random number generator operates only in sub-sequence parallelization mode. In contrast, oneMKL’s standard implementation uses a&nbsp;sequential approach. As a result, these two implementations of the same random number generator will produce different sequences.</p>
                        <p style="text-align:justify">Switching to sub-sequence mode allows obtaining the same sequences if both random number generators have the same initialization seed.</p>
                        <p class="mb-5" style="text-align:justify">The transition to oneMKL can be further simplified by using the Intel® DPC++ Compatibility Tool. It offers automated code transformation, analysis, and optimization capabilities. Furthermore, it allows for automatic transition from cuRAND to oneMKL’s RNG domain, preserving the output sequence.</p>
                    </section>

                    <section id="dk_scalability_pre">
                        <h3 style="font-weight: 300;">Scalability while Preserving Randomness</h3>
                        <p style="text-align:justify">Adding the sub-sequence parallelization method for the MRG32k3a random number generator in the Intel oneMKL library efficiently generates high-quality pseudo-random numbers on GPUs. Dividing the output sequence into multiple sub-streams that can be processed in parallel can achieve this without compromising statistical quality.</p>
                        <p style="text-align:justify">The sub-sequence technique finds the right balance between scalability and randomness for the MRG32k3a random number generator. The provided usage examples demonstrate how this method can be easily integrated into existing oneMKL workflows, allowing developers to take advantage of parallel computation on GPUs for random number generation. Incorporating this method into oneMKL improves usability and compatibility by facilitating the transition of applications from other GPU math libraries like cuRAND. This ultimately accelerates simulations, numerical analysis, and other applications relying on large volumes of high-quality random data, regardless of whether an application is best scaled to run on discrete Intel® Arc™ Graphics GPUs, integrated GPUs based on Intel® Xe2 Graphics, Intel® Data Center GPUs, or even third-party compute accelerators.</p>
                    </section>

                    <p class="">&nbsp;</p>

                    <section id="dk_get_the_software">
                        <h3 style="font-weight: 300;">Get the Software</h3>
                        <p>Download the&nbsp;<a href="" style="color:#467886; text-decoration:underline !important">Intel® oneAPI Math Kernel Library</a>&nbsp;(oneMKL) stand-alone&nbsp;or as part of the&nbsp;<a href="" style="color:#467886; text-decoration:underline !important">Intel® oneAPI Base Toolkit</a>, a core set of tools and libraries for developing high-performance, data-centric applications across diverse architectures.</p>
                    </section>

                    <p class="mb-0">&nbsp;</p> 

                    <section id="dk_additional_res">
                        <h3 style="font-weight: 300;">Additional Resources</h3>
                        <p class="mb-0">Here are more resources you may be interested in:</p>
                        <ul>
                            <li><a href="" style="color:#467886; text-decoration:underline !important">Intel® oneAPI Math Kernel Library (oneMKL) - Data Parallel C++ Developer Reference</a>
                        
                            <ul style="list-style-type:circle">
                                <li><a href="" style="color:#467886; text-decoration:underline !important">Skip-Ahead Method</a></li>
                            </ul>
                            </li>
                            <li><a href="" style="color:#467886; text-decoration:underline !important">Intel® oneAPI Math Kernel Library Link Line Advisor</a></li>
                            <li><a href="" style="color:#467886; text-decoration:underline !important">Intel® DPC++ Compatibility Tool</a></li>
                            <li><a href="" style="color:#467886; text-decoration:underline !important">oneMKL Random Number Generator Device Routines</a></li>
                            <li><a href="" style="color:#467886; text-decoration:underline !important">Random Number Generation with cuRAND* and oneMKL</a></li>
                        </ul>
                    </section>

                    <p class="mb-0">&nbsp;</p> 

                    <section id="dk_references">
                        <h3 style="font-weight: 300;">References</h3>
                        <p style="text-align:justify">[1] - Pierre L'Ecuyer, (1999) Good Parameters and Implementations for Combined Multiple Recursive Random Number Generators. Operations Research 47(1):159-164. <a href="" style="color:#467886; text-decoration:underline !important">https://pubsonline.informs.org/doi/10.1287/opre.47.1.159</a></p>
                        <p>[2] – <a href="" style="color:#467886; text-decoration:underline !important">oneMKL Data Parallel C++ Developer Reference Skip Ahead Method</a></p>
                        <p>[3] - Pierre L'Ecuyer, Richard Simard, E. Jack Chen, W. David Kelton, (2002) An Object-Oriented Random-Number Package with Many Long Streams and Substreams. Operations Research 50(6):1073-1075. <a href="" style="color:#467886; text-decoration:underline !important">https://doi.org/10.1287/opre.50.6.1073.358</a></p>
                    </div>

                    <p class="mb-0">&nbsp;</p> 
                    
                    </section>
                </div>
            </div>
        </div>
    </section>


  
    

     <section style="border-top: 1px solid #d7d7d7;" class="container py-5">
        <h4 class="h6">Product and Performance Information</h4>
        <div class="disclaimer" style="font-size: 12px;"><sup>1</sup> Performance varies by use, configuration and other factors. Learn more at <a class="b_special_a1" href="">www.Intel.com/PerformanceIndex</a>.</div>
        </div>
    </section>

    <!-- footer -->
    <div id="footer"></div>

    <!-- script header and footer -->
    <script>
        // navbar include  
        fetch('/y_index/y_navbar.html')
            .then(response => response.text())
            .then(data => {
                document.getElementById('navbar').innerHTML = data;
            });
        // footer include 
        fetch('/y_index/y_footer.html')
            .then(response => response.text())
            .then(data => {
                document.getElementById('footer').innerHTML = data;
            });
    </script>

    <!-- nav script -->
    <script>
        document.addEventListener('DOMContentLoaded', function () {
        if (document.getElementsByClassName('VK_all_sections section') && document.getElementsByClassName('VK_sidebar_dropdown')) {
            const sections = document.querySelectorAll('.VK_all_sections section');
            const navLinks = document.querySelectorAll('.VK_sidebar_dropdown a');
            const detailsElements = document.querySelectorAll('.VK_sidebar_dropdown details');

            function removeActiveClass() {
                navLinks.forEach(link => link.classList.remove('VK_sidebar_active_link'));
                detailsElements.forEach(details => {
                    details.removeAttribute('open');
                    details.setAttribute('close', ''); // Optional: to visually indicate it's closed
                });
            }

            function activateLinkAndDetails(targetId) {
                navLinks.forEach(link => {
                    if (link.getAttribute('href') === `#${targetId}`) {
                        link.classList.add('VK_sidebar_active_link');
                        let parentDetails = link.closest('details');

                        // Open all ancestor details elements
                        while (parentDetails) {
                            parentDetails.setAttribute('open', '');
                            parentDetails.removeAttribute('close'); // Optional: remove the closed indicator
                            parentDetails = parentDetails.parentElement.closest('details');
                        }
                    }
                });
            }

            function onScroll() {
                let currentSection = '';
                sections.forEach(section => {
                    const sectionTop = section.getBoundingClientRect().top;
                    const sectionBottom = section.getBoundingClientRect().bottom;

                    // Check if the section is in view
                    if (sectionTop <= 100 && sectionBottom >= 0) {
                        currentSection = section.getAttribute('id');
                    }
                });

                if (currentSection) {
                    removeActiveClass();
                    activateLinkAndDetails(currentSection);
                } else {
                    removeActiveClass();
                }
            }

            window.addEventListener('scroll', onScroll);
        } else {
            return
        }
    });
    </script>

    <!-- copy script -->
    <script>
        document.addEventListener("DOMContentLoaded", () => {
            document.querySelectorAll(".mv_copy_icon").forEach((icon) => {
                icon.addEventListener("click", async function () {
                    try {
                        const toolbar = this.closest(".mv_code_toolbar");
                        const codeBlock = toolbar.querySelector(".code-content");
                        const codeContent = codeBlock.innerText;
    
                        // Use Clipboard API to copy text
                        await navigator.clipboard.writeText(codeContent);
    
                        // Hide the copy icon and show the "Copied!" message
                        const message = toolbar.querySelector(".mv_copy_message");
                        this.classList.add("hidden"); // Hide the copy icon
                        message.classList.remove("hidden"); // Show the "Copied!" message
    
                        // Hide the message and show the icon again after 2 seconds
                        setTimeout(() => {
                            message.classList.add("hidden");
                            this.classList.remove("hidden");
                        }, 2000); // Adjust delay as needed
    
                    } catch (err) {
                        console.error('Failed to copy text: ', err);
                    }
                });
            });
        });
    </script>

</body>

</html>
