<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Optimize Containerized Workloads with Docker & WSL</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

    <link href=" https://fonts.cdnfonts.com/css/intel-clear " rel="stylesheet">
    <link rel="stylesheet" href="../css/owl.carousel.min.css">
    <link rel="stylesheet" href="../css/yatri.css">
    <link rel="stylesheet" href="../css/rushita.css">
    <link rel="stylesheet" href="../css/rushita_automotive.css">

    <link rel="stylesheet" href="../css/owl.theme.default.min.css">
    <style>
        * {
            font-family: 'Intel Clear', sans-serif;
        }

        .dk_new_options_table {
            border: none !important;
            justify-content: center !important;
            text-align: center !important;
        }

        .dk_new_options_table thead tr td {
            margin-left: 0;
            max-width: fit-content;
            white-space: normal;
            overflow: auto;
            background: #fff;
            padding: 1rem;
            text-align: left;
            border-left: .125rem solid #e2e2e2;
            font-weight: 700 !important;
        }

        .dk_new_options_table thead tr:nth-child(even) td {
            background-color: #f7f7f7;
        }

        .mv_intel_amx h2 {
            font-weight: 300;
        }

        .mv_intel_amx {
            font-size: 1.25rem;
        }

        .mv_intel_amx_bg_color {
            background-color: #0068B5;
        }

        .mv_intel_amx_content {
            padding-right: 200px;
        }

        .mv_intel_amx_item {
            align-content: center;
        }

        .mv_intel_amx {
            color: #fff;
            padding: 1rem;
        }

        .mv_intel_amx h3 {
            font-weight: 300;
        }

        .mv_intel_amx p {
            margin-top: 1.5rem;
            margin-bottom: 0rem;
        }

        .mv_intel_amx_image {
            padding: 1rem;
        }

        .mv_intel_amx_image img {
            width: 100%;
            /* height: 199px; */
        }

        .mv_intel_amx_heading_text {
            font-size: 1.2rem;
            line-height: 1.15;
        }

        .VK_sidebar_active_link {
            color: #262626;
            font-weight: 700;
        }

        .VK_sidebar_active_link:hover {
            color: #262626;
        }

        .VK_print_email_font span {
            font-size: 1.375rem;
        }

        .VK_side_bar_postion_stickey {
            position: sticky;
            top: 0px;
            z-index: 3;
            background-color: #fff;
        }

        .VK_side_heading {
            font-size: 26px;
            font-weight: 400;
        }

        .VK_sidebar_dropdown P {
            margin-left: .313rem !important;
            margin-bottom: .313rem !important;
        }

        .VK_sidebar_dropdown details {
            margin-left: .313rem !important;
            margin-bottom: .313rem !important;
        }
        code {
    color: #000 !important;
    background-color: #E6E6E6;
}
    </style>
</head>

<body>
    <div id="navbar"></div>

    <section class="m_ai_tdrop">
        <div>
            <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                Developers
            </button>
            <ul class="dropdown-menu">
                <li><a class="dropdown-item m_dropActive"
                        href="../dhruvin_developer-tools/ds_Developer-Zone.html">Overview</a></li>
                <li><a class="dropdown-item m_dropActive"
                        href="../rushita_Solutions/k_solutions_in_Viewall_SDF_Industrial-Automation_Control-flow-Enforcement_Technology.html">Topics
                        & Technologies</a></li>
                <li><a class="dropdown-item m_dropActive"
                        href="../dhruvin_developer-tools/ds_Development-Tools.html">Tools</a></li>
                <li><a class="dropdown-item m_dropActive"
                        href="../rushita_Solutions/k_solutions_in_Viewall_SDF_Industrial-Automation_Hardware-Platforms.html">Hardware
                        Platforms</a></li>
                <li><a class="dropdown-item m_dropActive"
                        href="../dhruvin_developer-tools/ds_Resource-Documentation-Center.html">Resources &
                        Documentation</a></li>
                <li><a class="dropdown-item m_dropActive" href="../dhruvin_developer-tools/ds_Learn.html">Learn</a>
                </li>
                <li><a class="dropdown-item m_dropActive"
                        href="../dhruvin_developer-tools/ds_Communities-and-Events.html">Community & Events</a></li>
                <li><a class="dropdown-item m_dropActive"
                        href="../dhruvin_developer-tools/ds_Developer-Programs.html">Developer Programs</a></li>
                <li><a class="dropdown-item m_dropActive" href="../dhruvin_developer-tools/ds_Get-Help.html">Get
                        Help</a></li>
            </ul>
        </div>


        <div class="m_ai_shlash">/</div>
        <div>
            <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                Tools
            </button>
            <ul class="dropdown-menu">
                <li><a class="dropdown-item m_dropActive" href="../Product/B20_developer_catelog.html">Software
                        Catalog</a></li>
                <li><a class="dropdown-item m_dropActive" href="../Product/B17_oneapi.html">oneAPI</a></li>
                <li><a class="dropdown-item m_dropActive"
                        href="../rushita_Solutions/k_solutions_Intel-Tiber™Edge-Platform.html">Intel® Tiber™ Edge
                        Platform</a></li>
                <li><a class="dropdown-item m_dropActive" href="../Product/B10_intel_Quarts.html">FPGA</a></li>
                <li><a class="dropdown-item m_dropActive" href="../VK_developers/VK_technology_sdk.html">Intel®
                        Active Management Technology SDK</a></li>
                <li><a class="dropdown-item m_dropActive" href="../VK_developers/VK_intel_adviser.html">Intel®
                        Advisor</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Intel® AI Reference Models</a></li>
                <li><a class="dropdown-item m_dropActive"
                        href="../rushita_Solutions/k_solutions_Intel-Collaboration-Suite-for-WebRTC.html">Intel®
                        Collaboration Suite for WebRTC SDK</a>
                </li>
                <li><a class="dropdown-item m_dropActive" href="../Product/B1_19_Intel_AICloud.html">Intel® Tiber™
                        AI Cloud</a></li>
                <li><a class="dropdown-item m_dropActive"
                        href="../rushita_Solutions/k_solutions_Intel-Distribution-for-Python.html">Intel® Distribution
                        for Python*</a></li>
                <li><a class="dropdown-item m_dropActive"
                        href="../rushita_Solutions/k_solutions_Intel-Distribution-for-GDB.html">Intel® Distribution for
                        GDB*</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Intel® DPC++ Compatibility Tool</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Intel® Dynamic Application Loader</a></li>
                <li><a class="dropdown-item m_dropActive"
                        href="../rushita_Solutions/k_solutions_Topics_viewall_Cloud-Insider-Program_AI-Frameworks-and-Tools.html">Frameworks</a>
                </li>
                <li><a class="dropdown-item m_dropActive" href="#">Intel® Embree</a></li>
                <li><a class="dropdown-item m_dropActive" href="../VK_developers/VK_ai_scikit.html">Intel® Extension
                        for Scikit-learn*</a></li>
                <li><a class="dropdown-item m_dropActive"
                        href="../rushita_Solutions/k_solutions_Intel-Fortran-Compiler.html">Intel® Fortran Compiler</a>
                </li>
                <li><a class="dropdown-item m_dropActive" href="#">Intel® Graphics Performance Analyzers</a></li>
                <li><a class="dropdown-item m_dropActive"
                        href="../rushita_Solutions/k_solutions_Intel-HE-Toolkit.html">Intel® Homomorphic Encryption
                        Toolkit</a></li>
                <li><a class="dropdown-item m_dropActive"
                        href="../rushita_Solutions/k_solutions_Intel-In-Band-Manageability.html">Intel® In-Band
                        Manageability</a></li>
                <li><a class="dropdown-item m_dropActive"
                        href="../rushita_Solutions/k_solutions_Intel-Cryptography-Primitives-Library.html">Intel®
                        Integrated Performance Primitives</a></li>
                <li><a class="dropdown-item m_dropActive" href="../rushita_Solutions/">Intel® Integrated Simulation
                        Infrastructure with
                        Modeling</a></li>
                <li><a class="dropdown-item m_dropActive"
                        href="../rushita_Solutions/k_solutions_Instruction-Set-Architecture(ISA)Extensions.html">Instruction
                        Set Architecture (ISA) Extensions</a>
                </li>
                <li><a class="dropdown-item m_dropActive"
                        href="../rushita_Solutions/k_solutions_Intel-Intelligent-Storage-Acceleration-Library.html">Intel®
                        Intelligent Storage Acceleration Library
                        (Intel® ISA-L)</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Modin*</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Intel® MPI Library</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Intel® Neural Compressor</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">OpenCL™ Runtime</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Intel® Open Image Denoise</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Intel® Open Path Guiding Library (Intel® Open
                        PGL)</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Pin</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Intel® Platform Analysis Library</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Intel Tools for OpenCL™ Software</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Intel Tools for OpenCL™ Applications</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Intel® OpenSWR</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">OpenVINO™ Toolkit</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Intel® Open Volume Kernel Library</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Intel® Optimization for XGBoost*</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Intel® OSPRay</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Intel® OSPRay for Hydra*</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Intel® OSPRay Studio</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">PyTorch* Optimizations from Intel</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">TensorFlow* Optimizations from Intel</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Intel® Rendering Toolkit</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Intel® Smart Edge Open</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Intel® Software Guard Extensions</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Intel® Secure Device Onboard</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Intel® Software Development Emulator</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Intel® Trust Domain Extensions (Intel® TDX)</a>
                </li>
                <li><a class="dropdown-item m_dropActive" href="#">Intel® Quantum SDK</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Intel® Query Processing Library (Intel® QPL)</a>
                </li>
                <li><a class="dropdown-item m_dropActive" href="#">Intel® Video Processing Library</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Intel® VTune™ Profiler</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Resellers</a></li>
            </ul>
        </div>
        <div class="m_ai_shlash">/</div>
        <div>
            <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                oneAPI
            </button>
            <ul class="dropdown-menu">
                <li><a class="dropdown-item m_dropActive" href="#">Overview</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Data Parallel C++/SYCL*</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Toolkits</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Tech Articles & How-Tos</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Components</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Code Samples</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Training</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Documentation</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Support</a></li>
            </ul>
        </div>
        <div class="m_ai_shlash">/</div>
        <div>
            <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                Tech Articles & How-Tos
            </button>
            <ul class="dropdown-menu">
                <li><a class="dropdown-item m_dropActive" href="#">Library</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">News Updates</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Webinars</a></li>
            </ul>
        </div>
        <div class="m_ai_shlash">/</div>
        <div class="m_ai_httl">Optimize Containerized Workloads with Docker & WSL
        </div>
    </section>
    <section class="k_bgblue">
        <div class="k_container11">
            <div class="row text-white py-4">
                <h3 class="fw-light">Docker, WSL, and oneAPI — A Quick How-To Guide</h3>
                <p>Optimizing a containerized oneAPI workload for deployment</p>
            </div>
        </div>
    </section>
    <section class="k_space k_spacenone">
        <div class="k_container11">
            <div class="row  g-3">
                <div class="float-end k_bignone" style="padding-left:70%;">
                    <div>
                        <a href="#" class="fs-4"><i class="fa-solid fa-print mx-3 k_icon0"></i></a>
                        <a href="#" class="fs-4"> <i class="fa-regular fa-envelope k_icon0"></i></a>
                    </div>
                </div>
                <div class="col-lg-3 col-md-4 col-sm-12">
                    <div class="VK_sticky_side_bar VK_side_bar_postion_stickey">
                        <div>
                            <div class="VK_sidebar_dropdown">
                                <ul class="k_listnone k_menu ">
                                    <li class="k_text"><a href="#section1">What is a container?</a></li>
                                    <li class="k_text"><a href="#section2">What does this mean to a developer?</a></li>
                                    <li class="k_text"><a href="#section3">Using the oneAPI Development Containers</a></li>
                                    <li class="k_text"><a href="#section4">Building some code</a></li>
                                    <li class="k_text"><a href="#section5">Creating a Production Container</a></li>
                                    <li class="k_text"><a href="#section6">Making my production container 4x smaller</a></li>
                                    <li class="k_text"><a href="#section7">Conclusion</a></li>
                                    <li class="k_text"><a href="#section8" class="k_submenu-toggle">See Related Content</a>
                                        <ul class="k_listnone k_submenu">
                                            <li class="k_text"><a href="#section9"></a>Podcasts</a></li>
                                            <li class="k_text"><a href="#section10"></a>Technical Articles</a></li>
                                            <li class="k_text"><a href="#section11"></a>Get the Software</a></li>
                                        </ul>
                                    </li>
                                
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div>
                      <p><b>
                        Get the Latest on All Things CODE</b></p>
                        <p class="text-center k_btnget py-2 k_under k_btn100 my-2 kcokbtn1024" style="width: 80px;">
                            <a href="#" class="text-white">Sign Up</a>
                        </p>
                        <div class="d-flex gap-4 mt-4">
                            <div>
                                <img src="../img/rushita_img/tony.jpg" alt="" width="100px" style="border-radius: 100%;">
                            </div>
                            <div>
                                <p><b>Tony Mongkolsmai</b></p>
                                <p>Technology Evangelist, Intel Corporation</p>
                                <p class="k_plink1"><a href="#">Twitter*</a></p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-8 col-md-7 col-sm-12  k_16smpx k_width75">
                    <div class="float-end mx-3 k_smnone">
                        <div>
                            <a href="#" class="fs-4"><i class="fa-solid fa-print mx-3 k_icon0"></i></a>
                            <a href="#" class="fs-4"> <i class="fa-regular fa-envelope k_icon0"></i></a>
                        </div>
                    </div>
                    <div class=" k_smpaddnone k_smpaddnone1 pt-5">
                    <p>In my last blog, I spent some time talking about why being efficient as a developer matters to me. The proliferation of container technology can significantly help us achieve that goal.</p>
                        <h2 class="fw-light mt-5">What is a container?</h2>
                        <p class="k_plink1 k_intext1blue1">First though, let’s quickly go through what a container is for those who don’t know. Docker is the most common containerization solution, so I’ll take the definition of a container from their&nbsp;<a href="#">website</a>:</p>
                        <div class="col-xs-12 m-3">
                            <div class="d-flex">
                                <div>
                                    <i><i class="fa-solid fa-quote-left k_lefticon"
                                            style="font-size: 100px !important;"></i></i>
                                </div>
                                <div class="mx-3">
                                    <p><em>A container is a standard unit of software that packages up code and all its dependencies so the application runs quickly and reliably from one computing environment to another. A Docker container image is a lightweight, standalone, executable package of software that includes everything needed to run an application: code, runtime, system tools, system libraries and settings.</em></p>
                                </div>
                            </div>
                        </div>
                        <p class="k_plink1 k_intext1blue1">Containers can run on Windows or Linux systems, are relatively easy to set up and deploy, and are easy to share or distribute to others (via services like&nbsp;<a href="#">Docker Hub</a>).</p>
                        <p>Of course, there are some limitations to using containers as well. You have to set up a container runtime on every system where you want to run your containers, containers can get quite large, which may be an issue if you are having to upload and download them often, and they don’t provide hard separation of resources on the underlying system like a virtual machine (VM) would. Despite these limitations, for many use cases containers are an awesome way to go, so let’s talk about how it helps us as developers.</p>

                        <h2 class="fw-light mt-5">What does this mean to a developer?</h2>
                        <p>Using containers as part of our development process means you can create and maintain a stable, reproducible environment from which to develop software. If you ever corrupt your development environment, it is as easy as starting another instance of the container to get a clean environment to work in.</p>
                        <p>Another cool thing is you can create and run multiple developments and test environments (aka multiple Linux versions) on a single system. Most importantly, you generally don’t have to worry about messing up your host system since the container isolates most resources.</p>
                        <p>For developers whose customers use containers, shipping your application in a container allows you to run in a more controlled environment. This can help reduce bugs, reduce your testing surface area, and improve your time to market (TTM), which helps both you and your customers.</p>
                        <p>There are other options available to solve some of the “multiple development environment” problems such as virtual machine (VM)-based solutions. You can create a base Windows Subsystem for Linux (WSL) instance, configure your development environment in it and deploy the instance multiple times. You also could use enterprise solutions like a VMware Virtual Desktop Infrasture (VDI) which are even more robust. However, these solutions aren’t available to everyone on all platforms, so for the purposes of this blog, I will focus on leveraging containers to help develop and deploy software using oneAPI.</p>
                        
                        <h2 class="fw-light mt-5">Using the oneAPI Development Containers</h2>
                        <p>To leverage the oneAPI development containers to provide the aforementioned, stable development environment, we first need to set up Docker on our development system. In general, you can just go to Docker’s website and follow their installation instructions. You may remember from my previous blog that I’m using the WSL environment for my development, so it was slightly trickier.</p>
                        <p class="k_plink1 k_intext1blue1">I was going to do a simple write-up on this, but fortunately many people before me have done it. I found&nbsp;<a href="#">ferarias</a>’&nbsp;<a href="#">story</a>&nbsp;to be the simplest to understand if you want to follow this approach.</p>
                        <p>Once Docker is set up, you can grab the latest and greatest oneAPI development containers from Docker Hub.</p>
                        <p>There are oneAPI development containers for developing oneAPI code on CentOS8, Ubuntu 18.04, or Ubuntu 20.04. For this example, I’m going to build and package some simple SYCL code, so I’m going to pull the oneAPI Base Toolkit, Ubuntu 20.04 image. Using the Docker command line, I just run:</p>
                        <div class="p-3" style="border: 1px solid #CCCCCC;">
                            <div class="float-end p-3">
                                <i class="fa-solid fa-copy fs-4" style="color: #0068B5;"></i>
                            </div>
                            <p><div class="toolbar"><div class="toolbar-item"><i class="fa fa-docs"></i></div></div>> docker pull intel/oneapi-basekit:devel-ubuntu20.04<br>
                               </p>
                        </div>
                        <p>This downloads the container to my local system. To get into the development environment you can run the container using the following command:</p>
                        <div class="p-3" style="border: 1px solid #CCCCCC;">
                            <div class="float-end p-3">
                                <i class="fa-solid fa-copy fs-4" style="color: #0068B5;"></i>
                            </div>
                            <p><div class="toolbar"><div class="toolbar-item"><i class="fa fa-docs"></i></div></div>> docker run -ti --name=ubuntu-dev-20.04 intel/oneapi-basekit:devel-ubuntu20.04<br>
                               </p>
                        </div>
                        <p>The&nbsp;<span class="code-simple"><code style="background-color: #E6E6E6;">-ti</code></span>&nbsp;flag tells Docker to provide me with an interactive terminal in the container once it is up and running. The name flag gives our running container the name ubuntu-dev-20.04.</p>

                        <h2 class="fw-light mt-5">Building some code</h2>
                        <p>To make things a bit simpler, I will be leveraging the oneAPI samples. I went to the oneAPI samples Github:</p>
                        <div style="border: 1px solid #CCCCCC;">
                            <img src="../img/rushita_img/oneapi1.jpg" alt="" width="100%">
                            <div class="p-3">
                                <p class="fs-5"><b><a href="#" style="color: black; text-decoration: none;">oneapi-src/oneAPI-samples: Samples for Intel® oneAPI Toolkits</a></b></p>
                                <p>Samples for Intel® oneAPI Toolkits. Contribute to oneapi-src/oneAPI-samples development by creating an account on GitHub.</p>
                                <div class="d-flex justify-content-between">
                                    <div>
                                        <i class="fa-brands fa-github"></i><span class="twt px-2" style="color: grey;">GitHub</span>
                                    </div>
                                    <div>
                                        <i class="fa-solid fa-circle-exclamation" style="color: grey;"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <p>…and cloned the repo in my development container. I’ll be using the&nbsp;<span class="code-simple" style="background-color: #E6E6E6;"><code>Nbody</code></span>&nbsp;sample located in the&nbsp;<span class="code-simple"><code>DirectProgramming-&gt;DPC++-&gt;N-BodyMethods-&gt;Nbody</code></span>&nbsp;folder.</p>
                        <p>The nice thing about using the development container is I do NOT have to run:</p>
                        <div class="p-3" style="border: 1px solid #CCCCCC;">
                            <div class="float-end p-3">
                                <i class="fa-solid fa-copy fs-4" style="color: #0068B5;"></i>
                            </div>
                            <p><div class="toolbar"><i class="fa fa-docs"></i></div>> mkdir build<br>
                               </p>
                               <p><i class="fa fa-docs"></i>> cd build<br>
                               </p>
                               <p><i class="fa fa-docs"></i>> cmake ..<br>
                               </p>
                               <p><i class="fa fa-docs"></i>> make<br>
                               </p>
                               <p><i class="fa fa-docs"></i>> make run<br>
                               </p>
                        </div>
                        <p>As I did in my last example because the oneAPI development container was built having already run this command. I simply can go to the&nbsp;<code>Nbody</code>&nbsp;folder and follow the instructions to build and run the&nbsp;<code>Nbody</code>&nbsp;example:</p>
                 
                        <p>Here’s the output on my Intel i9 Alder Lake Alienware R13 system:</p>
                        <div class="my-5 col-sm-12 col-md-8 m-auto">
                            <img src="../img/rushita_img/docker.png" alt="" width="100%">
                        </div>

                        <h2 class="fw-light mt-5">Creating a Production Container</h2>
                        <p>Now that we know our code builds in the development container, let’s see how we can ship it in a container to a customer to run on their system.</p>
                        <p class="k_plink1 k_intext1blue1">Docker will build a new container using the&nbsp;<a href="#">Dockerfile</a>&nbsp;format. For those of you who are not familiar with how to use a Dockerfile, check out Docker’s&nbsp;<a href="#">Getting Started</a>&nbsp;guide.</p>
                        <p class="k_plink1 k_intext1blue1">I’m going to leverage the Docker&nbsp;<a href="#">multi-stage build</a>&nbsp;capability to tell the docker build process to build my code in one container and then copy it to another container. This allows me to have the entire build and package workflow in a single place, while still allowing me to ship a container without all the development tools. Here’s my production container Dockerfile:</p>
                        <div class="p-3" style="border: 1px solid #CCCCCC;">
                            <div class="float-end p-3">
                                <i class="fa-solid fa-copy fs-4" style="color: #0068B5;"></i>
                            </div>
                            <p><div class="toolbar"><i class="fa fa-docs"></i></div># run the development container and name it mybuild<br>
                                FROM intel/oneapi-basekit:devel-ubuntu20.04 as mybuild
                               </p>
                               <p><i class="fa fa-docs"></i># get oneAPI sample code<br>
                                RUN git clone https://github.com/oneapi-src/oneAPI-samples
                               </p>
                               <p><i class="fa fa-docs"></i># build the Nbody sample to root directory<br>
                                RUN cmake /oneAPI-samples/DirectProgramming/DPC++/N-BodyMethods/Nbody
                                RUN make
                               </p>
                               <p><i class="fa fa-docs"></i># use oneapi-runtime container as my production container<br>
                                FROM intel/oneapi-runtime:latest
                               </p>
                               <p><i class="fa fa-docs"></i># copy file from mybuild to the production container<br>
                                COPY - from=mybuild src/nbody /
                                CMD ["/nbody"]
                               </p>
                        </div>
                        <p>You’ll see that for the production container I’m using the&nbsp;<code>intel/oneapi-runtime:latest</code>&nbsp;container as a base because it provides all the runtimes required to run any oneAPI-based workload.</p>
                        <p>The next step is to take this Dockerfile, which I named&nbsp;<code>Dockerfile.runtime</code>, and run the docker build command to create my new container.</p>
                        <div class="p-3" style="border: 1px solid #CCCCCC;">
                            <div class="float-end p-3">
                                <i class="fa-solid fa-copy fs-4" style="color: #0068B5;"></i>
                            </div>
                            <p><div class="toolbar"><div class="toolbar-item"><i class="fa fa-docs"></i></div></div>> docker build . -f Dockerfile.runtime -t tonymintel/nbody:runtime<br>
                               </p>
                        </div>
                        <p>This command tells Docker to build using the current path, my&nbsp;<code>Dockerfile.runtime</code>&nbsp;file and tagging the image as&nbsp;<code>tonym/nbody:runtime</code>.</p>
                        <div class="my-5 col-sm-12 col-md-8 m-auto">
                            <img src="../img/rushita_img/docker1.png" alt="" width="100%">
                        </div>
                        <p class="utility-text-1" style="text-align:center"><em>A successful docker build! Yay!</em></p>
                        <p>A quick run of the container shows that our build was completed successfully and is running out of code as we want.</p>
                        <div class="my-5 col-sm-12 col-md-8 m-auto">
                            <img src="../img/rushita_img/docker2.png" alt="" width="100%">
                        </div>
                        <p>Now I just need to package up my container and ship it to my customer. I can push it up to Docker Hub or use the docker save command to save the image on my local system and send the file.</p>
                        <p>In my case, I’m just pushing it up to Docker Hub:</p>
                        <div class="p-3" style="border: 1px solid #CCCCCC;">
                            <div class="float-end p-3">
                                <i class="fa-solid fa-copy fs-4" style="color: #0068B5;"></i>
                            </div>
                            <p><div class="toolbar"><div class="toolbar-item"><i class="fa fa-docs"></i></div></div>> docker push tonymintel/nbody:runtime<br>
                               </p>
                        </div>
                        <p>This pushes the image to my&nbsp;<code>tonymintel</code>&nbsp;Docker Hub account and saves it to the&nbsp;<code>nbody</code>&nbsp;repository with the tag runtime. Now anyone with access to the&nbsp;<code>tonymintel/nbody</code>&nbsp;Docker Hub repository can pull and run the code via regular Docker commands.</p>
                        <div class="my-5 col-sm-12 col-md-8 m-auto">
                            <img src="../img/rushita_img/docker3.png" alt="" width="100%">
                        </div>
                        <p class="utility-text-1" style="text-align: center;"><em>Tagged nbody repo on Docker Hub</em></p>

                        <h2 class="fw-light mt-5">Making my production container 4x smaller</h2>
                        <p>Just as being efficient as a developer is important to me, having an efficient solution is important to users of our applications. As my colleague James Reinders says, we need to make sure we bring them “Joy Out of the Box.”</p>
                        <p>From my screenshot, you can see the container I’ve uploaded is 1.32GB. That’s a pretty big Docker container for my customer to download.</p>
                        <p>My production container is based on the intel/oneapi-runtime container, which provides all the runtimes for all toolkits that build oneAPI code. This isn’t necessarily a bad thing. oneAPI provides a variety of libraries that I may want to integrate with my code, so having a runtime package that I know will run my code is great. However, since I’m the developer and I know what libraries I used, let’s see if we can optimize our production container to make it smaller.</p>
                        <div class="my-5 col-sm-12 col-md-8 m-auto">
                            <img src="../img/rushita_img/docker3.png" alt="" width="100%">
                        </div>
                        <p  style="text-align: center;"><em>The intel/oneapi-runtime:latest Docker Hub file as of June 2022</em></p>
                        <p>After some inspection, I created a new Dockerfile.prod that looks like this:</p>
                        <div class="p-3" style="border: 1px solid #CCCCCC;">
                            <div class="float-end p-3">
                                <i class="fa-solid fa-copy fs-4" style="color: #0068B5;"></i>
                            </div>
                            <p><div class="toolbar"><i class="fa fa-docs"></i></div># run the development container and name it mybuild<br>
                                FROM intel/oneapi-basekit:devel-ubuntu20.04 as mybuild
                               </p>
                               <p><i class="fa fa-docs"></i># get oneAPI sample code<br>
                                RUN git clone https://github.com/oneapi-src/oneAPI-samples
                               </p>
                               <p><i class="fa fa-docs"></i># build the Nbody sample to root directory<br>
                                RUN cmake /oneAPI-samples/DirectProgramming/DPC++/N-BodyMethods/Nbody
                                RUN make
                               </p>
                               <p><i class="fa fa-docs"></i># build the production containerbr
                                FROM ubuntu:20.04
                                RUN apt-get update && \
                                DEBIAN_FRONTEND=noninteractive apt-get install -y - no-install-recommends \
                                curl ca-certificates gpg-agent software-properties-common
                               </p>
                               <p><i class="fa fa-docs"></i># repository to install Intel(R) oneAPI Libraries<br>
                                RUN curl -fsSL https://apt.repos.intel.com/intel-gpg-keys/GPG-PUB-KEY-INTEL-SW-PRODUCTS-2023.PUB | apt-key add -
                                RUN echo "deb [trusted=yes] https://apt.repos.intel.com/oneapi all main " > /etc/apt/sources.list.d/oneAPI.list
                               </p>
                               <p><i class="fa fa-docs"></i># repository to install Intel(R) GPU drivers<br>
                                RUN curl -fsSL https://repositories.intel.com/graphics/intel-graphics.key | apt-key add -
                                RUN echo "deb [trusted=yes arch=amd64] https://repositories.intel.com/graphics/ubuntu focal main" > 
                                /etc/apt/sources.list.d/intel-graphics.list
                               </p>
                               <p><i class="fa fa-docs"></i># pull required Intel runtime packages needed<br>
                                RUN apt-get update && \
                                DEBIAN_FRONTEND=noninteractive apt-get install -y - no-install-recommends \
                                intel-oneapi-runtime-dpcpp-cpp
                                ENV LANG=C.UTF-8
                                ENV LD_LIBRARY_PATH=/opt/intel/oneapi/lib
                               </p>
                               <p><i class="fa fa-docs"></i># copy file from build container to our production container<br>
                                COPY - from=build src/nbody /
                                CMD ["/nbody"]
                               </p>
                        </div>
                        <p>There’s a lot of text here, so let me try to explain what is going on:</p>
                        <ol> 
                            <li id="781c">Lines 1–9 and 32–34 are the same in both Dockerfiles. They build our binary and run it when the container starts</li> 
                           </ol>
                           <p>Lines 11–30 are mostly boilerplate code that sets up Intel’s apt repositories and then installs some Intel packages via APT. These lines are pulled from the&nbsp;<code>oneapi-runtime</code>&nbsp;Dockerfile, which can be found here:</p>
                           <div style="border: 1px solid #E6E6E6;">
                                <div class="d-flex gap-3">
                                    <div>
                                        <img src="../img/rushita_img/cat.jpg" alt="" height="150px">
                                    </div>
                                    <div>
                                        <div class="p-3">
                                            <p class="fs-5"><b><a href="#" style="color: black; text-decoration: none;">intel/oneapi-containers</a></b></p>
                                            <p>Contribute to intel/oneapi-containers development by creating an account on GitHub.</p>
                                            <div class="d-flex justify-content-between">
                                                <div>
                                                    <i class="fa-brands fa-github"></i><span class="twt px-2" style="color: grey;">GitHub</span>
                                                </div>
                                                <div>
                                                    <i class="fa-solid fa-circle-exclamation" style="color: grey;"></i>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                           </div>
                           <p class="k_plink1 k_intext1blue1">The key line in my&nbsp;<code>Dockerfile.prod</code>&nbsp;is line 28. If you go look at the original&nbsp;<code>intel/oneapi-runtime</code>&nbsp;Dockerfile (<a href="#">click here</a>&nbsp;and click on a digest SHA and find the biggest image layer), it does an apt-get for all the possible runtime packages. In my case, I know I only used DPC++, so my&nbsp;<code>Dockerfile.prod</code>&nbsp;only includes that&nbsp;<code>intel-oneapi-runtime-dpcpp-cpp</code>&nbsp;package.</p>
                           <p>Now I just build my new Dockerfile, verify it works as before, and push it to the cloud.</p>
                           <div class="p-3" style="border: 1px solid #CCCCCC;">
                            <div class="float-end p-3">
                                <i class="fa-solid fa-copy fs-4" style="color: #0068B5;"></i>
                            </div>
                            <p><div class="toolbar"><div class="toolbar-item"><i class="fa fa-docs"></i></div></div>> docker build . -f Dockerfile.prod -t tonymintel/nbody:production<br>
                                > docker run -it tonymintel/nbody:production <br>
                                > docker push tonymintel/nbody:production
                               </p>
                        </div>
                           <p>Now I see ~4x improvement in download size for my customer…a little more Joy Out of the Box hopefully.</p>
                           <div class="my-5 col-sm-12 col-md-8 m-auto">
                            <img src="../img/rushita_img/docker3.png" alt="" width="100%">
                        </div>
                        <p>You might ask, can I do better even? To avoid suspense, the answer is yes, but it involved going in and pulling individual files to omit various unused runtime components. It’s a little bit cumbersome, but it is possible. If you’re curious, it ended up making the package about 250MB for a ~5x improvement.</p>
                        <p>I consider this a big win because it can really affect your customer’s experience. Obviously, if your customer needs to download a container over a standard internet connection this is a big win. In a large-scale environment like a data center or cloud environment, this may be even more valuable since deploying the same pod on tens or hundreds of nodes is very common and network usage, saturation, and latency is always a concern. Perhaps most importantly, if your customer is paying for network or storage to deploy their containers, they’ll thank you (or at least won’t complain) about the container costing them more. :)</p>

                        <h2 class="fw-light mt-5">Conclusion</h2>
                        <p>Containers are a useful technology to help us as developers build and test our code. Depending on our customer (aka will they use a container), it also can really help us ship more reliable code to our customer.</p>
                        <p>There’s definitely some work that goes into learning all the technology, but it is definitely worth it in many cases. I hope this helped you learn a little about how to leverage containers and how to optimize those containers for your customer.</p>
                        <p>Until next time!</p>
                        <p class="greyHighlight k_plink1 k_intext1blue1 p-2" style="background-color: #E6E6E6;"><strong>Want to Connect? </strong>If you want to see what random tech news I’m reading, you can <a href="#">follow me</a> on Twitter.<br> Tony is a Software Architect and Technical Evangelist at Intel. He has worked on several software developer tools and most recently led the software engineering team that built the data center platform which enabled Habana’s scalable MLPerf solution.</p>

                        <h2 class="fw-light mt-5">See Related Content</h2>
                        <h3>Podcasts</h3>
                        <ul>
                            <li class="tab-pane-content k_plink1 k_intext1blue1"><a href="#">How Open Source Collaboration is Building a Heterogeneous Future</a></li>
                        </ul>
                        <h3>Technical Articles<a class="inpage-nav-anchor" id="inpage-nav-7-1"></a></h3>
                        <div class="tab-pane-content">
                            <ul>
                                <li class="k_plink1 k_intext1blue1"><a href="#">Free Your Software from Vendor Lock-in using SYCL and oneAPI</a></li>
                                <li class="k_plink1 k_intext1blue1"><a href="#">Accelerating Open Development through oneAPI Centers of Excellence</a></li>
                                <li class="k_plink1 k_intext1blue1"><a href="#">Building a Standards-Based Ecosystem for Heterogeneous Parallelism</a></li>
                                <li class="k_plink1 k_intext1blue1"><a href="#">SYCLomatic: A New CUDA-to-SYCL Code Migration Tool</a></li>
                            </ul>
                            
                            <h3>Get the Software<a class="inpage-nav-anchor" id="inpage-nav-7-2"></a></h3>
                            
                            <div class="tab-pane-content k_plink1 k_intext1blue1"><strong><a href="#">Intel® oneAPI Base Toolkit</a></strong><br>
                            Get started with this core set of tools and libraries for developing high-performance, data-centric applications across diverse architectures.</div>
                            
                            <div class="tab-pane-content k_plink1 k_intext1blue1"><br>
                            <strong class="k_plink1 k_intext1blue1"><a href="#">Get It Now</a></strong><br>
                            <br>
                            <a href="#">See All Tools</a></div>
                            </div>
                    </div>
                </div>
            </div>
    </section>
    <section class="my-4" style="font-size: 13px;">
        <div class="k_container11">
            <div class="row">
                <div>
                    <hr class="mb-5">
                    <p>Product and Performance Information </p>
                    <div class="k_plink1 k_intext1blue1"><sup>1</sup>Performance varies by use, configuration and other
                        factors. Learn more at &nbsp;<a href="#">www.Intel.com/PerformanceIndex.</a>.
                    </div>
                </div>
            </div>
        </div>
    </section>
    <div id="footer"></div>
    <script>
        // navbar include  
        fetch('../y_index/y_navbar.html')
            .then(response => response.text())
            .then(data => {
                document.getElementById('navbar').innerHTML = data;
            });
        // footer include 
        fetch('../y_index/y_footer.html')
            .then(response => response.text())
            .then(data => {
                document.getElementById('footer').innerHTML = data;
            });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/@splidejs/splide@4.1.4/dist/js/splide.min.js"></script>
    <script src="../js/jquery-3.7.1.js"></script>

    <script src="../js/owl.carousel.min.js"></script>
    <script src="../js/rushita.js"></script>
</body>

</html>