<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CUDA2SYCL Migration of SynxFlow Flood Modelling</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

    <link href=" https://fonts.cdnfonts.com/css/intel-clear " rel="stylesheet">
    <link rel="stylesheet" href="../css/owl.carousel.min.css">
    <link rel="stylesheet" href="../css/yatri.css">
    <link rel="stylesheet" href="../css/rushita.css">
    <link rel="stylesheet" href="../css/rushita_automotive.css">

    <link rel="stylesheet" href="../css/owl.theme.default.min.css">
    <style>
        * {
            font-family: 'Intel Clear', sans-serif;
        }

        .dk_new_options_table {
            border: none !important;
            justify-content: center !important;
            text-align: center !important;
        }

        .dk_new_options_table thead tr td {
            margin-left: 0;
            max-width: fit-content;
            white-space: normal;
            overflow: auto;
            background: #fff;
            padding: 1rem;
            text-align: left;
            border-left: .125rem solid #e2e2e2;
            font-weight: 700 !important;
        }

        .dk_new_options_table thead tr:nth-child(even) td {
            background-color: #f7f7f7;
        }

        .mv_intel_amx h2 {
            font-weight: 300;
        }

        .mv_intel_amx {
            font-size: 1.25rem;
        }

        .mv_intel_amx_bg_color {
            background-color: #0068B5;
        }

        .mv_intel_amx_content {
            padding-right: 200px;
        }

        .mv_intel_amx_item {
            align-content: center;
        }

        .mv_intel_amx {
            color: #fff;
            padding: 1rem;
        }

        .mv_intel_amx h3 {
            font-weight: 300;
        }

        .mv_intel_amx p {
            margin-top: 1.5rem;
            margin-bottom: 0rem;
        }

        .mv_intel_amx_image {
            padding: 1rem;
        }

        .mv_intel_amx_image img {
            width: 100%;
            /* height: 199px; */
        }

        .mv_intel_amx_heading_text {
            font-size: 1.2rem;
            line-height: 1.15;
        }

        .VK_sidebar_active_link {
            color: #262626;
            font-weight: 700;
        }

        .VK_sidebar_active_link:hover {
            color: #262626;
        }

        .VK_print_email_font span {
            font-size: 1.375rem;
        }

        .VK_side_bar_postion_stickey {
            position: sticky;
            top: 0px;
            z-index: 3;
            background-color: #fff;
        }

        .VK_side_heading {
            font-size: 26px;
            font-weight: 400;
        }

        .VK_sidebar_dropdown P {
            margin-left: .313rem !important;
            margin-bottom: .313rem !important;
        }

        .VK_sidebar_dropdown details {
            margin-left: .313rem !important;
            margin-bottom: .313rem !important;
        }

        code {
            color: #000 !important;
            background-color: #E6E6E6;
        }

        .k_btn {
            height: 80px;
        }

        .code-simple {
            background-color: #E6E6E6;
        }

        pre {
            white-space: pre-line !important;
        }
    </style>
</head>

<body>
    <div id="navbar"></div>

    <section class="m_ai_tdrop">
        <div>
            <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                Developers
            </button>
            <ul class="dropdown-menu">
                <li><a class="dropdown-item m_dropActive"
                        href="../dhruvin_developer-tools/ds_Developer-Zone.html">Overview</a></li>
                <li><a class="dropdown-item m_dropActive"
                        href="../rushita_Solutions/k_solutions_in_Viewall_SDF_Industrial-Automation_Control-flow-Enforcement_Technology.html">Topics
                        & Technologies</a></li>
                <li><a class="dropdown-item m_dropActive"
                        href="../dhruvin_developer-tools/ds_Development-Tools.html">Tools</a></li>
                <li><a class="dropdown-item m_dropActive"
                        href="../rushita_Solutions/k_solutions_in_Viewall_SDF_Industrial-Automation_Hardware-Platforms.html">Hardware
                        Platforms</a></li>
                <li><a class="dropdown-item m_dropActive"
                        href="../dhruvin_developer-tools/ds_Resource-Documentation-Center.html">Resources &
                        Documentation</a></li>
                <li><a class="dropdown-item m_dropActive" href="../dhruvin_developer-tools/ds_Learn.html">Learn</a>
                </li>
                <li><a class="dropdown-item m_dropActive"
                        href="../dhruvin_developer-tools/ds_Communities-and-Events.html">Community & Events</a></li>
                <li><a class="dropdown-item m_dropActive"
                        href="../dhruvin_developer-tools/ds_Developer-Programs.html">Developer Programs</a></li>
                <li><a class="dropdown-item m_dropActive" href="../dhruvin_developer-tools/ds_Get-Help.html">Get
                        Help</a></li>
            </ul>
        </div>


        <div class="m_ai_shlash">/</div>
        <div>
            <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                Tools
            </button>
            <ul class="dropdown-menu">
                <li><a class="dropdown-item m_dropActive" href="../Product/B20_developer_catelog.html">Software
                        Catalog</a></li>
                <li><a class="dropdown-item m_dropActive" href="../Product/B17_oneapi.html">oneAPI</a></li>
                <li><a class="dropdown-item m_dropActive"
                        href="../rushita_Solutions/k_solutions_Intel-Tiber™Edge-Platform.html">Intel® Tiber™ Edge
                        Platform</a></li>
                <li><a class="dropdown-item m_dropActive" href="../Product/B10_intel_Quarts.html">FPGA</a></li>
                <li><a class="dropdown-item m_dropActive" href="../VK_developers/VK_technology_sdk.html">Intel®
                        Active Management Technology SDK</a></li>
                <li><a class="dropdown-item m_dropActive" href="../VK_developers/VK_intel_adviser.html">Intel®
                        Advisor</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Intel® AI Reference Models</a></li>
                <li><a class="dropdown-item m_dropActive"
                        href="../rushita_Solutions/k_solutions_Intel-Collaboration-Suite-for-WebRTC.html">Intel®
                        Collaboration Suite for WebRTC SDK</a>
                </li>
                <li><a class="dropdown-item m_dropActive" href="../Product/B1_19_Intel_AICloud.html">Intel® Tiber™
                        AI Cloud</a></li>
                <li><a class="dropdown-item m_dropActive"
                        href="../rushita_Solutions/k_solutions_Intel-Distribution-for-Python.html">Intel® Distribution
                        for Python*</a></li>
                <li><a class="dropdown-item m_dropActive"
                        href="../rushita_Solutions/k_solutions_Intel-Distribution-for-GDB.html">Intel® Distribution for
                        GDB*</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Intel® DPC++ Compatibility Tool</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Intel® Dynamic Application Loader</a></li>
                <li><a class="dropdown-item m_dropActive"
                        href="../rushita_Solutions/k_solutions_Topics_viewall_Cloud-Insider-Program_AI-Frameworks-and-Tools.html">Frameworks</a>
                </li>
                <li><a class="dropdown-item m_dropActive" href="#">Intel® Embree</a></li>
                <li><a class="dropdown-item m_dropActive" href="../VK_developers/VK_ai_scikit.html">Intel® Extension
                        for Scikit-learn*</a></li>
                <li><a class="dropdown-item m_dropActive"
                        href="../rushita_Solutions/k_solutions_Intel-Fortran-Compiler.html">Intel® Fortran Compiler</a>
                </li>
                <li><a class="dropdown-item m_dropActive" href="#">Intel® Graphics Performance Analyzers</a></li>
                <li><a class="dropdown-item m_dropActive"
                        href="../rushita_Solutions/k_solutions_Intel-HE-Toolkit.html">Intel® Homomorphic Encryption
                        Toolkit</a></li>
                <li><a class="dropdown-item m_dropActive"
                        href="../rushita_Solutions/k_solutions_Intel-In-Band-Manageability.html">Intel® In-Band
                        Manageability</a></li>
                <li><a class="dropdown-item m_dropActive"
                        href="../rushita_Solutions/k_solutions_Intel-Cryptography-Primitives-Library.html">Intel®
                        Integrated Performance Primitives</a></li>
                <li><a class="dropdown-item m_dropActive" href="../rushita_Solutions/">Intel® Integrated Simulation
                        Infrastructure with
                        Modeling</a></li>
                <li><a class="dropdown-item m_dropActive"
                        href="../rushita_Solutions/k_solutions_Instruction-Set-Architecture(ISA)Extensions.html">Instruction
                        Set Architecture (ISA) Extensions</a>
                </li>
                <li><a class="dropdown-item m_dropActive"
                        href="../rushita_Solutions/k_solutions_Intel-Intelligent-Storage-Acceleration-Library.html">Intel®
                        Intelligent Storage Acceleration Library
                        (Intel® ISA-L)</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Modin*</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Intel® MPI Library</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Intel® Neural Compressor</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">OpenCL™ Runtime</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Intel® Open Image Denoise</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Intel® Open Path Guiding Library (Intel® Open
                        PGL)</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Pin</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Intel® Platform Analysis Library</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Intel Tools for OpenCL™ Software</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Intel Tools for OpenCL™ Applications</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Intel® OpenSWR</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">OpenVINO™ Toolkit</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Intel® Open Volume Kernel Library</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Intel® Optimization for XGBoost*</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Intel® OSPRay</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Intel® OSPRay for Hydra*</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Intel® OSPRay Studio</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">PyTorch* Optimizations from Intel</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">TensorFlow* Optimizations from Intel</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Intel® Rendering Toolkit</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Intel® Smart Edge Open</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Intel® Software Guard Extensions</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Intel® Secure Device Onboard</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Intel® Software Development Emulator</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Intel® Trust Domain Extensions (Intel® TDX)</a>
                </li>
                <li><a class="dropdown-item m_dropActive" href="#">Intel® Quantum SDK</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Intel® Query Processing Library (Intel® QPL)</a>
                </li>
                <li><a class="dropdown-item m_dropActive" href="#">Intel® Video Processing Library</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Intel® VTune™ Profiler</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Resellers</a></li>
            </ul>
        </div>
        <div class="m_ai_shlash">/</div>
        <div>
            <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                oneAPI
            </button>
            <ul class="dropdown-menu">
                <li><a class="dropdown-item m_dropActive" href="#">Overview</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Data Parallel C++/SYCL*</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Toolkits</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Tech Articles & How-Tos</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Components</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Code Samples</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Training</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Documentation</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Support</a></li>
            </ul>
        </div>
        <div class="m_ai_shlash">/</div>
        <div>
            <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                Tech Articles & How-Tos
            </button>
            <ul class="dropdown-menu">
                <li><a class="dropdown-item m_dropActive" href="#">Library</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">News Updates</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Webinars</a></li>
            </ul>
        </div>
        <div class="m_ai_shlash">/</div>
        <div class="m_ai_httl">CUDA2SYCL Migration of SynxFlow Flood Modelling
        </div>
    </section>
    <section style="background-color: #0068B5;">
        <div class="k_container11">
            <div class="row  py-3">
                <div
                    class="col-lg-8 col-md-12 col-sm-12   mx-0 text-white align-content-center  k_tstartauto k_text2  px-0 mx-0 k_mdorder2 ">
                    <h3 class="fs-2 mb-2 fw-lighter k_marketsmall">Fine-Tuning the Falcon 7-Billion Parameter Model with
                        Hugging Face and oneAPI</h3>

                    <p>University of Birmingham leverages SYCL for GPU offload more efficient than original CUDA code
                    </p>
                </div>

            </div>
        </div>
    </section>
    <section class="k_space k_spacenone">
        <div class="k_container11">
            <div class="row  g-3">
                <div class="float-end k_bignone" style="padding-left:70%;">
                    <div>
                        <a href="#" class="fs-4"><i class="fa-solid fa-print mx-3 k_icon0"></i></a>
                        <a href="#" class="fs-4"> <i class="fa-regular fa-envelope k_icon0"></i></a>
                    </div>
                </div>
                <div class="col-lg-3 col-md-4 col-sm-12">
                    <div class="VK_sticky_side_bar VK_side_bar_postion_stickey">
                        <div>
                            <div class="VK_sidebar_dropdown">
                                <ul class="k_listnone k_menu ">
                                    <li class="k_text"><a href="#section1">Summary/Story at a Glance</a></li>
                                    <li class="k_text"><a href="#section2">Introduction</a></li>
                                    <li class="k_text"><a href="#section3">Challenge/Objective</a></li>
                                    <li class="k_text"><a href="#section4">Performance Results & Benefits</a></li>
                                    <li class="k_text"><a href="#section5">The Path to a Performant SYCL Solution</a>
                                    </li>
                                    <li class="k_text"><a href="#section6">What’s Next?</a></li>
                                    <li class="k_text"><a href="#section7">Get the Software</a></li>
                                    <li class="k_text"><a href="#section8">oneAPI and SYCL Resources</a></li>
                                    <li class="k_text"><a href="#section9">Resources About The Research</a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div>
                        <p><b>
                                Get the Latest on All Things CODE</b></p>
                        <p class="text-center k_btnget py-2 k_under k_btn100 my-2 kcokbtn1024" style="width: 80px;">
                            <a href="#" class="text-white">Sign Up</a>
                        </p>
                        <p id="singleauthorname" class="authorname">Dr Xilin Xia</p>

                        <p id="singleauthorbio" class="authorbio">
                        <p>Assistant Professor,</p>
                        <p>University of Birmingham</p>
                        </p>
                        </p>
                    </div>
                </div>
                <div class="col-lg-8 col-md-7 col-sm-12  k_16smpx k_width75">
                    <div class="float-end mx-3 k_smnone">
                        <div>
                            <a href="#" class="fs-4"><i class="fa-solid fa-print mx-3 k_icon0"></i></a>
                            <a href="#" class="fs-4"> <i class="fa-regular fa-envelope k_icon0"></i></a>
                        </div>
                    </div>
                    <div class=" k_smpaddnone k_smpaddnone1 pt-5">
                        <h2 class="fw-light mt-5">Summary/Story at a Glance</h2>
                        <p>The SynxFlow hydrodynamic modeling code was re-engineered using oneAPI, Intel’s
                            implementation of SYCL, a cross-vendor heterogeneous programming model. This transformation
                            aimed to address limitations in GPU compatibility and enhance scalability for
                            next-generation Exa-Scale High-Performance Computing (HPC) systems. The new implementation
                            delivers improved performance, interoperability, and scalability across diverse hardware
                            platforms, enabling ground-breaking large-scale probabilistic forecasting with high spatial
                            and temporal resolutions.&nbsp;&nbsp;</p>
                        <p class="k_plink1 k_intext1blue1">The SYCL implementation and Performance tests used components
                            of the Intel® oneAPI Base Toolkit and <a href="#">Dawn</a>, one of the UK’s newest and
                            fastest artificial intelligence (AI) supercomputers.<sup>[1]</sup>&nbsp;</p>

                        <h2 class="fw-light mt-5">Introduction</h2>
                        <p class="k_plink1 k_intext1blue1"><a href="#">SynxFlow</a><sup>[2]</sup> is an open-source
                            GPU-based hydrodynamic flood modeling software developed by Dr. Xilin Xia (University of
                            Birmingham) and his colleagues in CUDA*, C++, and Python*. The CUDA part runs the
                            simulations, while the Python code is used for data pre-processing and visualisation. As a
                            model that runs on multiple GPUs, SynxFlow can run flood simulations faster than real-time
                            with hundreds of millions of computational cells and metre-level resolution. As open-source
                            software with a user-friendly Python interface, it can be easily integrated into data
                            science workflows for risk assessments of disastrous circumstances. Therefore, the model has
                            been widely used for research and industry, for example, to support flood early warning
                            systems and generate flood maps for (re)insurance companies. &nbsp;</p>
                        <p>The SynxFlow software is capable of simulating flooding scenarios and related hazards,
                            including landslide runout and debris flow. Such simulations are vital in advance planning
                            and management of emergency services. A detailed prediction of natural hazards can help
                            mitigate their adverse social and economic impacts. Apart from risk assessment and disaster
                            preparedness, hazard simulation with SynxFlow can also assist in urban planning,
                            environmental protection, climate change adaption, insurance and financial planning,
                            infrastructure design and engineering, public awareness, and education.&nbsp;</p>
                        <p class="k_plink1 k_intext1blue1">In a collaborative project supported by the Natural
                            Environment Research Council between the <a href="#">University of Birmingham</a> and the <a
                                href="#">UK Centre for Ecology and Hydrology</a>, Dr Xia and his colleagues are
                            developing a new generation of probabilistic flood forecasting systems. &nbsp;</p>
                        <p>In the study, the team aims to develop a system capable of simulating river flow and
                            generating probabilistic high-resolution flood maps. This system will be created by the
                            SynxFlow model coupled with UKCEH’s G2G hydrological model. These probabilistic flood maps
                            are created by deriving likelihoods of flooding from a series of high-resolution flood maps
                            (Figure 1). They provide critical insights into the likelihood and severity of potential
                            flooding events, helping decision-makers and emergency responders better prepare for and
                            mitigate risks. &nbsp;</p>
                        <p class="k_plink1 k_intext1blue1">This poses a significant computational challenge due to the
                            demand for creating an ensemble of high-resolution flood simulations much faster than
                            real-time. To implement such a system, the team turned their eyes to the UK’s latest
                            supercomputer – <a href="#">DAWN</a><sup>[1]</sup>, with over 1000 Intel® Data Center GPU
                            Max 1550.&nbsp;</p>
                        <div class="my-4">
                            <img src="../img/rushita_img/synxflow1.png" alt="" width="100%">
                        </div>
                        <p style="text-align:center"><strong>Figure 1</strong>: An example of high-resolution flood map
                            created by SynxFlow for a city</p>

                        <h2 class="fw-light mt-5">Challenge/Objective</h2>
                        <p>The primary challenge was overcoming the hardware limitations imposed by the CUDA programming
                            model used by SynxFlow, which only supports NVIDIA* GPUs. Therefore, the first step in
                            building the new flood forecasting system is to port the original CUDA code to a new
                            language that supports the Intel® Data Center GPU Max Series on DAWN. The team also hoped
                            that the ported code would support GPUs from other vendors or even CPUs. After weighing
                            various options, the SynxFlow development team decided to leverage the Intel oneAPI Base
                            Toolkit - an implementation of the oneAPI specification backed by the Unified Acceleration
                            (UXL) Foundation. It is all based on multiarchitecture, multi-vendor supported SYCL
                            framework. &nbsp;With support for Intel, NVIDIA, and AMD* GPUs, it comes with the Intel®
                            DPC++ Compatibility Tool for easy and automated code migration from CUDA to SYCL. After
                            about 6 weeks of effort, the team has successfully made the SynxFlow model run on DAWN,
                            utilising as many as 64 GPUs simultaneously while still being able to run it on an NVIDIA
                            GPU Supercomputer with similar performance.&nbsp;</p>

                        <h2 class="fw-light mt-5">Performance Results & Benefits</h2>
                        <p>To test the performance, Dr Xia had initially chosen a case study of the West Midlands
                            region, which includes the city of Birmingham. The total area is 1050 km2, and the
                            simulation resolution is 2 m, which resulted in a total simulation size of 262.5 million
                            cells.&nbsp;&nbsp;</p>
                        <p>Two different supercomputers were used to test the model:&nbsp;</p>
                        <ul role="list">
                            <li aria-setsize="-1" role="listitem">
                                <p>EPSRC Tier-2 Baskerville Supercomputer: 228 NVIDIA* A100 GPUs&nbsp;</p>
                            </li>
                        </ul>
                        <ul role="list">
                            <li aria-setsize="-1" role="listitem">
                                <p>DAWN Supercomputer: 1024 Intel Data Center GPU Max 1550&nbsp;</p>
                            </li>
                        </ul>
                        <p>Three different scaling settings were used: 16 GPUs across 4 nodes, 32 GPUs across 8 nodes,
                            and 64 GPUs across 16 nodes. For a 3-hour long simulation, the running times are shown in
                            Figure 2. As the results show, the performances of the original CUDA code and the new SYCL
                            code are comparable. &nbsp;</p>
                        <p>&nbsp;</p>
                        <p class="note p-3" style="background-color: #E6E6E6; border: 3px solid #FDB813;"><strong>The
                                SYCL code is even faster than the original CUDA code on the same NVIDIA-based
                                supercomputer.</strong></p>
                        <p>&nbsp;</p>
                        <p>As seen in Figure 2, the same SYCL code's performance on different platforms is also
                            comparable.&nbsp;</p>
                        <div class="my-5">
                            <img src="../img/rushita_img/synxflow.png" alt="" width="100%">
                        </div>
                        <p style="text-align:center"><strong>Figure 2</strong>: Running time for a 3-hour simulation on
                            various supercomputers with different numbers of GPUs</p>
                        <p>The scaling efficiency is also encouraging, as is shown in Figure 3, both the SYCL and CUDA
                            code have achieved satisfactory strong scaling efficiency, with the efficiency of SYCL code
                            higher than CUDA code. &nbsp;</p>
                        <p>The efficiency of the SYCL code for 64 GPUs&nbsp;is 89%, which can be considered very high.
                            Due to the limits of simulation size and the maximum number of GPUs per job, we could not
                            run the simulation on a smaller or larger number of GPUs. For the CUDA code, the team could
                            only run the simulation with as many as 32 GPUs, the largest number of GPUs that could be
                            used per job.&nbsp;</p>
                        <p>&nbsp;</p>
                        <div>
                            <img src="../img/rushita_img/synxflow2.png" alt="" width="100%">
                        </div>
                        <p style="text-align:center"><strong>Figure 3</strong>: Strong scaling efficiencies of the CUDA
                            and SYCL code</p>
                        <p style="text-align:center">&nbsp;</p>
                        <p>After the new code has been proven to be performant on both CUDA and SYCL platforms, the team
                            is currently developing the new probabilistic flood forecasting system by coupling the
                            SynxFlow model with <a href="#">UKCEH’s G2G hydrological model</a><sup>[3]</sup>. The effort
                            of developing the new SYCL-based SynxFlow code has also been shortlisted for the prestigious
                            <a href="#">HPCWire Readers’ Choice Award in 2024</a>.&nbsp;</p>

                        <h2 class="fw-light mt-5">The Path to a Performant SYCL Solution</h2>
                        <p>When porting the code to SYCL, the team has followed the following steps:<br>
                            &nbsp;</p>
                        <ol>
                            <li><strong>Using the Intel DPC++ Compatibility Tool to Translate CUDA Kernels into
                                    SYCL:&nbsp;</strong><br>
                                <br>
                                The original SynxFlow code is organised using CMake. Although the Intel DPC++
                                Compatibility Tool supports the migration of CMake build environments in its latest
                                version, the decision was made to port these makefiles manually to provide a higher
                                level of control during migration on a Windows* machine. which the compatibility tool
                                does not support. To enable the tool to run, a new project was set up using Microsoft*
                                Visual Studio, which allowed running the porting tool successfully. Most kernels and API
                                calls were automatically translated into SYCL (see Figure 3 for an example). When
                                compiling the code, there were some errors, but they were easy to fix by following the
                                error message from the compiler. In this step, the NCCL library calls were not
                                translated, so only the single-GPU code was successfully compiled.&nbsp;
                            </li>
                        </ol>
                        <div class="p-2" style="border: 1px solid #CCCCCC;">
                            <p class="float-end fs-3"><i class="fa-solid fa-copy"></i></p>
                            <p class="col-12">
                            <div class="toolbar">
                                <div class="toolbar-item"><i class="fa fa-docs"></i></div>
                            </div>
                            <pre>
                                            __global__ void cuCalDepthDurationKernel(Scalar* h_old, Scalar* h, Scalar* t_hGTx, Scalar x, Scalar dt, unsigned int phi_size){ 

                                                unsigned int index = blockDim.x * blockIdx.x + threadIdx.x; 
                                            
                                                while(index &lt; phi_size){ 
                                            
                                                  Scalar t = t_hGTx[index]; 
                                            
                                                  if(h_old[index] &gt; x &amp;&amp;  h[index] &gt; x){ 
                                            
                                                    t += dt; 
                                            
                                                  }else{ 
                                            
                                                    t = 0.0; 
                                            
                                                  } 
                                            
                                                  t_hGTx[index] = t; 
                                            
                                                  index += blockDim.x * gridDim.x; 
                                            
                                                } 
                                            
                                              }
                                        </pre>
                            </p>
                        </div>
                        <p class="mt-3">(a) Original CUDA kernel</p>
                        <div class="p-2" style="border: 1px solid #CCCCCC;">
                            <p class="float-end fs-3"><i class="fa-solid fa-copy"></i></p>
                            <p class="col-12">
                            <div class="toolbar">
                                <div class="toolbar-item"><i class="fa fa-docs"></i></div>
                            </div>
                            <pre><div class="toolbar"><div class="toolbar-item"><i class="fa fa-docs"></i></div></div>
                                void cuCalDepthDurationKernel(Scalar* h_old, Scalar* h, Scalar* t_hGTx, Scalar x, Scalar dt, unsigned int phi_size, const sycl::nd_item&lt;3&gt; &amp;item_ct1){  

                                unsigned int index = item_ct1.get_local_range(2) * item_ct1.get_group(2) + 
                            
                                                     item_ct1.get_local_id(2); 
                            
                                while(index &lt; phi_size){ 
                            
                                  Scalar t = t_hGTx[index]; 
                            
                                  if(h_old[index] &gt; x &amp;&amp;  h[index] &gt; x){ 
                            
                                    t += dt; 
                            
                                  }else{ 
                            
                                    t = 0.0; 
                            
                                  } 
                            
                                  t_hGTx[index] = t; 
                            
                                  index += item_ct1.get_local_range(2) * item_ct1.get_group_range(2); 
                            
                                } 
                            
                              }</pre>
                            </p>
                        </div>
                        <p>(b) Migrated SYCL kernel</p>
                        <p style="text-align:center"><strong>Figure 4</strong>:&nbsp;Comparison between the original
                            CUDA kernel (a) and translated SYCL kernel (b)&nbsp;</p>
                        <p style="text-align:center">&nbsp;</p>
                        <p style="text-align:center">&nbsp;</p>
                        <ol start="2">
                            <li aria-setsize="-1" role="listitem">
                                <p><strong>Performance Profiling:</strong><br>
                                    <br>
                                    Once the code was successfully compiled, the next step was to evaluate its
                                    performance. To make the code run on NVIDIA GPUs, we used the Codeplay’s oneAPI for
                                    NVIDIA® GPUs plugin. Initial testing on a small test case revealed a noticeable
                                    performance loss. To investigate the issue, performance profiling tools were
                                    employed. The profiling results indicated that the function ‘cuEventCreate’ was
                                    being invoked after each kernel run, which raised concerns about its impact on
                                    overall efficiency. However, further analysis revealed minimal performance impact
                                    for larger test cases. Therefore, no further optimization had been done, and later,
                                    it was found that the ‘cuEventCreate’ is part of the features of Intel’s SYCL
                                    implementation.&nbsp;
                                </p>
                            </li>
                            <li aria-setsize="-1" role="listitem">
                                <p><strong>Implementing Inter-Node Communication using GPU-enabled MPI:</strong><br>
                                    <br>
                                    The final challenge involved enabling inter-node communication, critical for scaling
                                    the application across multiple GPUs. Our initial attempt involved using the Intel®
                                    oneAPI Collective Communications Library (oneCCL), Intel’s equivalent to the NVIDIA*
                                    Collective Communications Library (NCCL). However, the resulting code of this
                                    approach was not backward-compatible with NVIDIA-based HPC systems. As an
                                    alternative, the team replaced NCCL-based inter-GPU communication with
                                    GPU-direct-enabled MPI. On the CUDA platform, this was OpenMPI, and on the Intel
                                    platform, this was the Intel® MPI Library implementation. &nbsp;<br>
                                    <br>
                                    This adjustment proved effective, allowing the application to scale successfully on
                                    both Baskerville and DAWN. During large-scale runs, &nbsp;they observed minor
                                    discrepancies in results between CUDA and SYCL platforms. After investigating, they
                                    &nbsp;discovered that the Intel compiler’s default settings utilised speed optimised
                                    mathematical operations instead of the high precision model we prefer. &nbsp;They
                                    resolved the discrepancies by adjusting the compiler settings to prioritise math
                                    precision using ‘-fp-model=precise’, ensuring consistent results across both
                                    platforms. &nbsp;
                                </p>
                            </li>
                            <li aria-setsize="-1" role="listitem">
                                <p><strong>Configurations/Solution Ingredients:&nbsp;</strong><br>
                                    <br>
                                    <strong>For porting code from CUDA to SYCL:&nbsp;</strong><br>
                                    •&nbsp;Windows 10 Enterprise&nbsp;<br>
                                    • Microsoft Visual Studio 2019&nbsp;<br>
                                    •&nbsp;Intel® DPC++ Compatibility Tool as part of oneAPI 2024.0.1&nbsp;<br>
                                    <br>
                                    <strong>For testing on HPC hardware:&nbsp;</strong><br>
                                    <br>
                                    • On NVIDIA machine&nbsp;(Baskerville HPC)): 16 or 32 NVIDIA A100 GPUs, Intel® Xeon®
                                    Platinum 8360Y CPUs (2 CPUs per GPU during the job), CUDA Toolkit v11.1, OpenMPI
                                    4.1.1, Intel oneAPI Base Toolkit v2024.0.1, Codeplay’s oneAPI for NVIDIA*&nbsp;GPUs
                                    plugin, Red Hat Enterprise Linux 8.10<br>
                                    <br>
                                    • On Intel machine (DAWN HPC): 16, 32, or 64 Intel Data Center GPU Max 1550,
                                    Intel®&nbsp;Xeon®&nbsp;Platinum 8468 CPUs (2 CPUs per GPU during the job), Intel
                                    oneAPI Base Toolkit v2024.2.0 Rocky Linux 8&nbsp;
                                </p>
                            </li>
                        </ol>

                        <h2 class="fw-light mt-5">What’s Next? </h2>
                        <p class="k_plink1 k_intext1blue1">Get started with Intel DPC++ Compatibility Tool and its
                            open-source counterpart  <a href="#">SYCLomatic</a> to easily achieve automated, efficient
                            code portability from CUDA to SYCL for accelerated heterogenous computing across hardware
                            from diverse vendors.&nbsp;</p>
                        <p class="k_plink1 k_intext1blue1">We encourage you to check out practical application examples
                            of code migration available in the <a href="#">CUDA to SYCL catalogue</a>. Also explore <a
                                href="#">AI</a> and <a href="#">HPC</a>  tools in Intel’s <a href="#">oneAPI</a>-powered
                            software portfolio.&nbsp;</p>

                        <h2 class="fw-light mt-5">Get the Software</h2>
                        <p class="k_plink1 k_intext1blue1">Download the standalone version of Intel DPC++ Compatibility
                            Tool. The migration tool is available as a part of the <a href="#">Intel oneAPI Base
                                Toolkit</a>.   &nbsp;</p>

                        <h2 class="fw-light mt-5">oneAPI and SYCL Resources </h2>
                        <ul role="list">
                            <li aria-setsize="-1" role="listitem">
                                <p class="k_plink1 k_intext1blue1"><a href="#">Intel oneAPI programming model</a>&nbsp;
                                </p>
                            </li>
                        </ul>
                        <ul role="list">
                            <li aria-setsize="-1" role="listitem">
                                <p class="k_plink1 k_intext1blue1"><a href="#">Intel DPC++ Compatibility Tool
                                        documentation</a>&nbsp;</p>
                            </li>
                        </ul>
                        <ul role="list">
                            <li aria-setsize="-1" role="listitem">
                                <p class="k_plink1 k_intext1blue1"><a href="#">SYCLomatic documentation</a>&nbsp;</p>
                            </li>
                        </ul>
                        <ul role="list">
                            <li aria-setsize="-1" role="listitem">
                                <p class="k_plink1 k_intext1blue1"><a href="#">Migrate from CUDA to C++ with SYCL
                                        portal</a>&nbsp;</p>
                            </li>
                        </ul>
                        <ul role="list">
                            <li aria-setsize="-1" role="listitem">
                                <p class="k_plink1 k_intext1blue1"><a href="#">Codeplay’s oneAPI plugins for NVIDIA
                                        GPUs</a>&nbsp;</p>
                            </li>
                        </ul>
                        <p>&nbsp;</p>

                        <h2 class="fw-light mt-5">Resources About The Research </h2>
                        <ul role="list">
                            <li aria-setsize="-1" role="listitem">
                                <p class="k_plink1 k_intext1blue1"><a href="#">University of Birmingham</a> – <a
                                        href="#">School of Engineering</a>&nbsp;</p>
                            </li>
                        </ul>
                        <ul role="list">
                            <li aria-setsize="-1" role="listitem">
                                <p class="k_plink1 k_intext1blue1"><a href="#">Natural Environment Research
                                        Council</a>&nbsp;&nbsp;</p>
                            </li>
                        </ul>
                        <ul role="list">
                            <li aria-setsize="-1" role="listitem">
                                <p class="k_plink1 k_intext1blue1"><a href="#">UK Centre for Ecology and
                                        Hydrology</a>&nbsp;</p>
                            </li>
                        </ul>
                        <ul role="list">
                            <li aria-setsize="-1" role="listitem">
                                <p class="k_plink1 k_intext1blue1"><a href="#">Synxflow</a>&nbsp;</p>
                            </li>
                        </ul>
                        <p>&nbsp;</p>
                        <p class="k_plink1 k_intext1blue1"><sup>[1]</sup> <a
                                href="#">https://www.hpc.cam.ac.uk/d-w-n</a>&nbsp;</p>
                        <p class="k_plink1 k_intext1blue1"><sup>[2]</sup> <a
                                href="#">https://synxflow.readthedocs.io/en/latest/about.html</a>&nbsp;&nbsp;</p>
                        <p class="k_plink1 k_intext1blue1"><sup>[3]</sup> <a
                                href="#">https://catalogue.ceh.ac.uk/documents/2269c155-2f7d-4c4e-830a-851b2c2dc1fd</a>&nbsp;
                        </p>

                    </div>
                </div>
    </section>
    <section class="my-4" style="font-size: 13px;">
        <div class="k_container11">
            <div class="row">
                <div>
                    <hr class="mb-5">
                    <p>Product and Performance Information </p>
                    <div class="k_plink1 k_intext1blue1"><sup>1</sup>Performance varies by use, configuration and other
                        factors. Learn more at &nbsp;<a href="#">www.Intel.com/PerformanceIndex.</a>.
                    </div>
                </div>
            </div>
        </div>
    </section>
    <div id="footer"></div>
    <script>
        // navbar include  
        fetch('../y_index/y_navbar.html')
            .then(response => response.text())
            .then(data => {
                document.getElementById('navbar').innerHTML = data;
            });
        // footer include 
        fetch('../y_index/y_footer.html')
            .then(response => response.text())
            .then(data => {
                document.getElementById('footer').innerHTML = data;
            });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/@splidejs/splide@4.1.4/dist/js/splide.min.js"></script>
    <script src="../js/jquery-3.7.1.js"></script>

    <script src="../js/owl.carousel.min.js"></script>
    <script src="../js/rushita.js"></script>
</body>

</html>