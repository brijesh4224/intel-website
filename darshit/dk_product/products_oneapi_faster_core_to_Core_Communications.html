<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Faster Core-to-Core Communications</title>

    <link rel="stylesheet" href="/css/dk_developer_edge_iot_&_5G_social_distancing_for_retail_settings.css">

    <!-- header footer -->
    <link rel="stylesheet" href='/css/yatri.css'>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
        crossorigin="anonymous"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" rel="stylesheet">
</head>

<style>
    .dk_oneapi_deco{
        color: #0068b5;
        font-weight: bold;
    }
    .dk_oneapi_deco:hover{
        text-decoration: underline;
    }
    @media (max-width: 767px){
    .dk_designed_oneapi{
        flex-wrap: wrap-reverse !important;
    }
    .dk_designed_oneapi img{
        margin-bottom: 2rem;
        }  
    .dk_types_of_information img{
        width: 100% !important;
    }     
    }
    .dk_overview_api{
        word-wrap: break-word;
        background-color: #e6e6e6;
        padding: 20px;
        border-left: 3px solid #fdb813;
    }
    .dk_overview_api p{
        font-weight: bold;
    }
    .dk_overview_api_sub{
        color: blue;
        text-decoration: underline !important;
        font-weight: 700;
    }
    .dk_overview_api_sub:hover{
        color: blue;
    }
    .dk_overview_api_sub2{
        color: blue;
        text-decoration: underline !important;
        font-weight: 400;
    }
    .dk_overview_api_sub2:hover{
        color: blue;
    }
</style>

<body>

    <!-- header -->
    <div id="navbar"></div>

    <!-- Social Distancing for Retail Settings -->
    <section>
        <div class="mv_intel_amx_bg_color">
            <div class="container">
                <div class="row mv_intel_amx_content">
                    <div class="col-md-12 col-sm-12 mv_intel_amx_item">
                        <div class="mv_intel_amx">
                            <h1 style="font-weight: 300; font-size: 2.25rem;">Faster Core-to-Core Communications</h1>
                            <p>October 25, 2024</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section class="container py-5">
        <div class="row">
            <div class="d-flex justify-content-end col-xl-10 py-3 d-md-none">
                <i class="fa-solid fa-print fs-4 px-2 " style="color:#0068B5"></i>
                <i class="fa-regular fa-envelope fs-4 px-2" style="color:#0068B5"></i>
            </div>
            <div class="col-lg-3 col-md-4">
                <!-- nav -->
                <div class="VK_sticky_side_bar VK_side_bar_postion_stickey">
                    <div>
                        <div class="VK_sidebar_dropdown">
                            <p class="m-0">
                                <a href="#dk_problem_msg_latency" class="text-decoration-none VK_a">
                                    The Problem with Message Latency
                                </a>
                            </p>
                            <p class="m-0">
                                <a href="#dk_coherent_fundamentals" class="text-decoration-none VK_a">
                                    Coherent Memory Fundamentals
                                </a>
                            </p>
                            <p class="m-0">
                                <a href="#dk_coherent_memory" class="text-decoration-none VK_a">
                                    Coherent Memory Multicore Complexity
                                </a>
                            </p>
                            <details>
                                <summary>
                                    <a href="#dk_core_to_core_latency" class="text-decoration-none VK_a">
                                        Core to Core Latency
                                    </a>
                                </summary>
                                <ul class="list-unstyled ps-3 mb-0">
                                    <li>
                                        <a href="#dk_latency_test" class="text-decoration-none VK_a my-1">
                                            Latency Test Code Example
                                        </a>
                                    </li>
                                </ul>
                            </details>
                            <details>
                                <summary>
                                    <a href="#dk_core_to_core_band" class="text-decoration-none VK_a">
                                        Core-to-Core Bandwidth
                                    </a>
                                </summary>
                                <ul class="list-unstyled ps-3 mb-0">
                                    <li>
                                        <a href="#dk_core_to_core_msg" class="text-decoration-none VK_a my-1">
                                            Core-to-Core Messaging Takeaway
                                        </a>
                                    </li>
                                </ul>
                            </details>
                            <details>
                                <summary>
                                    <a href="#dk_ring_buffer" class="text-decoration-none VK_a">
                                        The Ring Buffer
                                    </a>
                                </summary>
                                <ul class="list-unstyled ps-3 mb-0">
                                    <li>
                                        <a href="#dk_configuration" class="text-decoration-none VK_a my-1">
                                            Configuration Details for Tests in this Article
                                        </a>
                                    </li>
                                </ul>
                                <ul class="list-unstyled ps-3 mb-0">
                                    <li>
                                        <a href="#dk_code_ex_classic" class="text-decoration-none VK_a my-1">
                                            Code Example: Classic Ring Buffer
                                            <ul style="list-style-type: none;">
                                                <a href="#message_noti"><li>Message Notification</li></a>
                                                <a href="#flow_control"><li>Flow Control</li></a>
                                            </ul>
                                        </a>
                                    </li>
                                </ul>
                                <ul class="list-unstyled ps-3 mb-0">
                                    <li>
                                        <a href="#dk_code_ex_ring" class="text-decoration-none VK_a my-1">
                                            Code Example: New Ring Buffer
                                        </a>
                                    </li>
                                </ul>
                                <ul class="list-unstyled ps-3 mb-0">
                                    <li>
                                        <a href="#dk_cache_line" class="text-decoration-none VK_a my-1">
                                            Cache Line Demote
                                        </a>
                                    </li>
                                </ul>
                            </details>
                            <p class="m-0">
                                <a href="#dk_conclusion" class="text-decoration-none VK_a">
                                    Conclusion
                                </a>
                            </p>
                            <p class="m-0">
                                <a href="#dk_download_tool" class="text-decoration-none VK_a">
                                    Download the Toolkits
                                </a>
                            </p>
                            <p class="m-0">
                                <a href="#dk_references_faster" class="text-decoration-none VK_a">
                                    References
                                </a>
                            </p>
                        </div>
                    </div>
                </div>
                <!-- thinkcode -->
                <div class="dk_things_code_main">
                    <div class="dk_things_code">
                        <h2 class="text-left headline-font-one-bold mb-4">Get the Latest on All Things CODE</h2>
                        <a class="dk_button" href="">Sign Up</a>
                        <p class="mb-0">&nbsp;</p>
                    </div> 
                </div>
                <p id="" class=""><p><a class="b_special_a2" href=""><b>Bryan Morgan</b></a>, Middleware Software Architect</p>
                <p><b>Ted Painter</b>, Middleware Software Architect</p>
                <p>Intel Corporation</p>
                <p>&nbsp;</p>
                <p><a class="b_special_a2" href=""><b>Lawrence Stewart</b></a>, CTO</p>
                <p>Serissa Research&nbsp;</p>
                </p>
            </div>
            <div class="col-lg-9 col-md-8">
                <div class="d-md-flex justify-content-end col-xl-10 py-3 d-none">
                    <i class="fa-solid fa-print fs-4 px-2 " style="color:#0068B5"></i>
                    <i class="fa-regular fa-envelope fs-4 px-2" style="color:#0068B5"></i>
                </div>
                <div class="col-xl-10 VK_all_sections">
                    <section id="dk_random_number">
                        <p class="mb-0">&nbsp;</p>
                        <p class="mb-0">&nbsp;</p>
                        <p class="mb-0">&nbsp;</p>
                    </section>

                    <section id="dk_problem_msg_latency">
                        <h3 style="font-weight: 300;">The Problem with Message Latency</h3>
                        <p>While memory bandwidth and thus throughput has improved tremendously over the years, end-to-end latency for short messages hasn’t changed much over the last 25 years. These short messages are, however, vital for multicore communication and compute for data intensive workloads in distributed systems. Not taking their importance into account can lead to serious performance degradation.</p>
                        <p>In this article, we will discuss using a mofified ring buffer to optimize short message latency and throughput. By carefully refining the design of the classic ring buffer, we can&nbsp;boost througput to 450 million 64-byte messages per second from multiple senders to a single 4<sup>th</sup> generation Intel® Xeon® Scalable Processor core (8 requestors and a single server thread).</p>
                        <p>This outlines the beginnings of our multi-front efforts to accelerate multicore coherent communication and distributed data management.&nbsp;</p>
                    </section>

                    <p class="">&nbsp;</p>

                    <section id="dk_coherent_fundamentals">
                     <h3 style="font-weight: 300">Coherent Memory Fundamentals</h3>
                     <p>Most programmers are aware of modern multicore processors’ basic coherent memory design: If one core writes a memory location and then another core reads it, the second core will get the new value. Of course, there are many additional subtleties to this, and different architectures have different models for “memory ordering,” but the general idea remains the same.</p>
                     <p>The workflow timing of sending individual messages is straightforward, with the general outline being.</p>

                     <div style="display: flex;">
                        <table align="center" border="1" cellpadding="1" cellspacing="1" style="width:700px" class="dk_new_options_table">
                            <thead>
                                <tr>
                                    <td style="background: #e2e2e2; text-align: left; border-right: 2px solid #fff !important;">Core 1</td>
                                    <td style="background: #e2e2e2; text-align: left;">Core 2</td>
                                </tr>
                                <tr>
                                    <td style="font-weight: 300 !important;">Write Message Buffer</td>
                                    <td></td>
                                </tr>
                                <tr>
                                    <td style="font-weight: 300 !important;">Atomic Write Flag with “release” semantics</td>
                                    <td></td>
                                </tr>
                                <tr>
                                    <td style="font-weight: 300 !important;"></td>
                                    <td style="font-weight: 300 !important;">Atomic Read Flag with “acquire” semantics</td>
                                </tr>
                                <tr>
                                    <td style="font-weight: 300 !important;"></td>
                                    <td style="font-weight: 300 !important;">Read Message Buffer</td>
                                </tr>
                            </thead>
                        </table>
                    </div>
                    <p>&nbsp;</p>

                    <p>The flag write with release semantics does whatever is necessary on the platform to ensure that the message buffer writes become visible to other threads no later than the write to the flag. The flag read with acquire semantics does whatever is necessary on the platform to ensure that the reads to the message buffer happen no earlier than the read of the flag.</p>

                    <p>This is all fine, but what happens when you want to send many messages?</p>

                    <p>The obvious thing to do is for the receiver to acknowledge the message by clearing the flag and for the sender to check the flag before writing a new message, but this turns out to be quite slow and thus inefficient.</p>
                    
                    </section>
                     <p class="mb-0">&nbsp;</p>

                     <section id="dk_coherent_memory"> 
                        <h3 style="font-weight: 300;">Coherent Memory Multicore Complexity</h3>
                        <p>So, let's examine the concept of coherency more closely to see if we can find a more compelling approach.</p>
                        <p>At the top of this post, we mentioned that modern multicore processors have coherent memory.&nbsp; In the early years of multiprocessors, this sort of thing was done by having each CPU read and write main memory on every access.&nbsp; There were no caches and no memory ordering issues.&nbsp; Cores are so fast these days, and main memory is so relatively slow that performance would be quite disappointing without caches.&nbsp; When one thread on one core is reading and writing memory, the caches intercept most accesses and quickly return results. However, it gets quite complicated when multiple cores want to use the same memory locations, either accidentally or on purpose.</p>
                        <p>Many designs use a coherence protocol called MESI (Modified, Exclusive, Shared, and Invalid), reflecting the accessibility and validity status of data. When multiple cores read a location, it can be in both caches in a “shared” state. When either core wishes to write, the other copy must first be invalidated. To address this, most designs use a cache directory type implementation where an on-chip “caching and home agent” keeps track of which cores have copies of each address and in which states.&nbsp;</p>
                        <p>When a core wishes to write, and the state is not exclusive, the core must ask the home agent for permission.&nbsp; If any other caches have copies, the home agent sends them “snoop invalidate” messages. Once those are acknowledged, the home agent sends the requesting cache permission to enter an exclusive state.</p>
                        <p>If a core wishes to read a location and it is invalid, the core must ask the home agent for permission.&nbsp; The home agent can either return the data (from memory or L3 cache) or if some other core has the location in exclusive (or modified) state, the home agent asks the owning agent to move to state shared and return any modified data to the agent so that the agent can deliver it to the requesting core.&nbsp;</p>
                        <p>Some designs use the MOESI (Modified Owned Exclusive Shared Invalid) protocol, which adds a fifth owner state. Owned data is tagged as both modified and shared. This designation allows modified data to be written back to the main memory before sharing it. While the data must still be written back eventually, the write-back may be deferred.</p>
                        <p>In short, it can get complicated, and the added complexity of all this messaging across the chip adds the potential for significant latency and performance degradation.</p>
                     </section>
                     <p class="mb-0">&nbsp;</p>


                    <section id="dk_core_to_core_latency">
                        <h3 style="font-weight: 300;">Core to Core Latency</h3>
                        <p>So, how long does it take for one core to set a flag and another core to notice it? Let us write a test program and find out!</p>
                        <p>Suppose we look, for example, at a two-socket <a class="b_special_a1" href="">Intel® Xeon® CPU Max 9480 Processor</a>-based system (code-named Sapphire Rapids) with 112 cores and 224 threads. Each core in this system has two hyperthreads, which share the core hardware.</p>
                        <p>The code example has two threads, which set themselves to run on specified cores and then bounce a flag back and forth, measuring the number of time stamp counter ticks it takes to complete a given number of handoffs.</p>
                    </section>
                    
                    <section id="dk_core_to_core_latency">
                        <h4>Latency Test Code Example</h4>

                          <!-- code toolbar 3 -->
                     <div class="mv_code_toolbar">
                        <div class="mv_toolbar_item mv_copy_icon">
                            <i class="fa-regular fa-copy"></i>
                        </div>
                        <div class="mv_copy_message text-end hidden">Copied</div>
                        <div class="code-content">
                            <div style="padding-bottom: 0rem !important" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc" class="pe-3">
                                    1
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0"><span class="dk_code_blue">void</span>  <span class="dk_code_org">*</span> remote_thread( <span class="dk_code_blue">void</span> <span class="dk_code_org">*</span> arg __attribute__ ( ( unused ) ) )</p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc" class="pe-3">
                                    2
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0"><span>{</span></p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc" class="pe-3">
                                    3
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; set_cpu ( remote_cpu ) ;</p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc" class="pe-3">
                                    4
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ready <span class="dk_code_org">=</span> <span class="dk_code_blue">1</span> ;</p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc" class="pe-3">
                                    5
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="dk_code_blue">for</span> ( <span class="dk_code_blue">uint64_t</span>  i <span class="dk_code_org">=</span>  1 ; i <span class="dk_code_org"><=</span>  nrequests ; i <span class="dk_code_org">+=</span>  <span class="dk_code_blue">2</span>) {</p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc" class="pe-3">
                                    6
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="dk_code_blue">while</span>  ( data . flag . load (std <span class="dk_code_org">: :</span> memory_order_acquire ) <span class="dk_code_org">!=</span> i );</p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc" class="pe-3">
                                    7
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data.flag.store ( i <span class="dk_code_org">+</span> <span class="dk_code_blue">1</span> , std <span class="dk_code_org"> : :</span> memory_order_release);</p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc" class="pe-3">
                                    8
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc" class="pe-3">
                                    9
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="dk_code_blue">return</span>  ( <span class="dk_code_blue"> NULL
                                        </span>  ) ;</p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc; padding-right: 7px;" class="">
                                    10
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0"> }</p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc; padding-right: 7px;" class="">
                                    11
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0"></p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc; padding-right: 7px;" class="">
                                    12
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0"><span class="dk_code_blue">unsigned long</span>  send_wait ( ) {</p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc; padding-right: 7px;" class="">
                                    13
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set_cpu ( main_cpu );</p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc; padding-right: 7px;" class="">
                                    14
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="dk_code_blue">while</span>  ( ready . load ( std <span class="dk_code_org">: :</span>  memory_order_acquire )  <span class="dk_code_org">==</span> <span class="dk_code_blue">0</span> ) ;</p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc; padding-right: 7px;" class="">
                                    15
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="dk_code_blue">unsigned long </span>start <span class="dk_code_org">=</span>  rdtsc ( ) ; s</p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc; padding-right: 7px;" class="">
                                    16
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="dk_code_blue">for</span> ( <span class="dk_code_blue">uint64_t</span> i =  <span class="dk_code_blue">1</span> ; i <= nrequests ; i += <span class="dk_code_blue">2</span> ) {</p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc; padding-right: 7px;" class="">
                                    17
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data.flag.store ( i , std <span class="dk_code_org">: :</span> memory_order_release ) ;</p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc; padding-right: 7px;" class="">
                                    18
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="dk_code_blue">while</span> ( data.flag.load ( std <span class="dk_code_org">: :</span> memory_order_acquire ) <span class="dk_code_org">!=</span> i <span class="dk_code_org">+</span> <span class="dk_code_blue">1</span> );</p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc; padding-right: 7px;" class="">
                                    19
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc; padding-right: 7px;" class="">
                                    20
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="dk_code_blue">unsigned long </span> stop <span class="dk_code_org">=</span> rdtsc();</p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc; padding-right: 7px;" class="">
                                    21
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="dk_code_blue">return</span> (stop <span class="dk_code_org">-</span> start);</p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc; padding-right: 7px;" class="">
                                    22
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0">}</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <p>In our example configuration, the read timestamp counter (RDTSC) ticks at 2 GHz, and the program shows the following data for half-round trip times.</p>

                    <div style="display: flex;">
                        <table align="center" border="1" cellpadding="1" cellspacing="1" style="width:500px" class="dk_new_options_table">
                            <thead>
                                <tr>
                                    <td style="background: #e2e2e2; text-align: left; border-right: 2px solid #fff !important;">Situation</td>
                                    <td style="background: #e2e2e2; text-align: left; border-right: 2px solid #fff !important;">RDTSC Counts</td>
                                    <td style="background: #e2e2e2; text-align: left;">Nanoseconds</td>
                                </tr>
                                <tr>
                                    <td style="font-weight: 300 !important;">Same core (other HT)</td>
                                    <td>33</td>
                                    <td>16.5</td>
                                </tr>
                                <tr>
                                    <td style="font-weight: 300 !important;">Same socke</td>
                                    <td>123</td>
                                    <td>61.5</td>
                                </tr>
                                <tr>
                                    <td style="font-weight: 300 !important;">Other socket</td>
                                    <td style="font-weight: 300 !important;">300</td>
                                    <td>150</td>
                                </tr>
                            </thead>
                        </table>
                    </div>
                    <p>&nbsp;</p>
                    <p>&nbsp;</p>
                    <div style="background-color: #e6e6e6; padding: 20px;">
                        <strong>Note:</strong>
                        <p class="mb-0">For a more detailed discussion of the effects resulting in these observations, you can check out <a class="b_special_a1" href="">Jason Rahman’s Core-to-Cory Latency study on SubStack</a> . [1]</p>
                    </div>
                    <p>&nbsp;</p>
                    </section>

                    <section id="dk_core_to_core_band">
                        <h3 style="font-weight: 300 !important;">Core-to-Core Bandwidth</h3>
                        <p>We have established that core-to-core communication latencies can easily become undesirably high, but what about bandwidth?&nbsp;</p>
                        <p>We can measure this, too, by writing a buffer on one core, waiting for the flag, and then reading the buffer on another core and measuring the time.&nbsp; Using the same platform configuration as before and a similar methodology, we find that if one core writes 32K bytes, it takes about 9000 RDTSC counts, or 4.5 microseconds, for another core to read it.&nbsp; That translates to about 7.3 GB/sec.&nbsp;</p>
                        <p>Interestingly, a recent new instruction called CLDEMOTE lets the programmer hint to the hardware that a cache line should be pushed down in the cache hierarchy, perhaps all the way to L3.&nbsp; When done, the second core can read 32K bytes in around 2900 RDTSC counts, or about 22 GB/sec. This number agrees with the observations John McCalpin reported in his presentation “<a href="" style="color:#467886; text-decoration:underline !important">Bandwidth Limits in the Intel® Xeon® CPU Max Series</a>” at the International Supercomputing 2023 IXPUG Workshop. &nbsp;[2]</p>
                        <p>We also know that a processor core can have quite a few outstanding memory operations.&nbsp; For example, in the first case here, reading data that is dirty in a different core’s cache, we can traverse 512 cache lines (32K bytes) in 4.5 microseconds, or about 8.8 nanoseconds each, even though the same socket round trip is 120 nanoseconds. The data flow here is delivered by combining out-of-order execution, multiple outstanding memory references, and aggressive hardware prefetching.</p>
                    </section>

                    <section id="dk_core_to_core_msg">
                        <h4>Core-to-Core Messaging Takeaway</h4>
                        <p>With these measurements, we can establish a “roofline” for core-to-core messages. They inform us of hardware limits to latency and bandwidth and a software goal.</p>
                        <p>The key takeaway from our observations thus far is that a fast core-to-core protocol should avoid memory coherence activity as much as possible.</p>
                        <p>At this point, we let us dig into a popular message queuing mechanism, the ring buffer, to see what additional controls on the core-to-core messaging performance we may have.</p>
                        <p class="mb-0">&nbsp;</p>
                    </section>

                    <section id="dk_ring_buffer">
                        <h4 style="font-weight: 300;">The Ring Buffer</h4>
                        <p>Ring buffer data structures have a long history of being used as bounded queues between producers and consumers. Many closed and open-source libraries, technical papers, and book expositions are available, as are ring buffer data structures.</p>
                        <p>For example, Herlihy’s “<a href="" style="color:#467886; text-decoration:underline !important">The Art of Multiprocessor Programming</a>” [3] devotes a chapter to the subject. Figure 1 shows a classic ring buffer design using shared control variables.</p>
                        <div class="">
                            <img class="w-100" src="/img/darshit_image/read-write-pointe-graph -core-2-core-comms.png" alt="">
                        </div>
                        <p><em><strong>Figure 1.</strong> Classic Ring Buffer Design</em></p>
                    </section>

                    <section id="dk_configuration">
                        <h4>Configuration Details for Tests in this Article</h4>
                        <p><strong>Testing Date: </strong>Performance results are <strong>based on testing by Intel as of October 25, 2024 </strong>and may not reflect all publicly available security updates.</p>
                        <p><strong>Configuration Details and Workload Setup: </strong>1-node, 1x Intel® Xeon® CPU Max 9480 processor on Denali Pass platform with 512 GB (16 slots/ 32GB/ 3200) total DDR5 memory, ucode 0x2c0001d1, HT on, Turbo on, EIST on, SUSE Linux Enterprise Server 15 SP5, 5.14.21-150500.55.80-default, 1x NVMe 1.0TB OS Drive; Intel(R) oneAPI DPC++/C++ Compiler 2024.2.0 (2024.2.0.20240602).</p>
                        <p>Performance results are based on testing as of dates shown in configurations and may not reflect all publicly available updates. See configuration disclosure for details.&nbsp; No product or component can be absolutely secure.</p>
                        <p>Performance varies by use, configuration, and other factors. Learn more at www.Intel.com/PerformanceIndex. Your costs and results may vary.</p>
                    </section>

                    <section id="dk_code_ex_classic">
                        <h4>Code Example: Classic Ring Buffer</h4>
                        <p>Let us look at a C++ class that implements the idea of a ring buffer:</p>
                
            
                         <!-- code toolbar 3 -->
                     <div class="mv_code_toolbar">
                        <div class="mv_toolbar_item mv_copy_icon">
                            <i class="fa-regular fa-copy"></i>
                        </div>
                        <div class="mv_copy_message text-end hidden">Copied</div>
                        <div class="code-content">
                            <div style="padding-bottom: 0rem !important" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc" class="pe-3">
                                    1
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0"> <span class="dk_code_blue">typedef struct</span> { </p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc" class="pe-3">
                                    2
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="dk_code_blue">uint32_t</span> data [ <span class="dk_code_blue">15</span> ];</p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc" class="pe-3">
                                    3
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; std <span class="dk_code_org">: :</span> atomic_uint32_t sequence</p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc" class="pe-3">
                                    4
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0">} message_t ;</p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc" class="pe-3">
                                    5
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0"></p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc" class="pe-3">
                                    6
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0"><span class="dk_code_blue">class</span> alignas ( CACHELINE_SIZE ) Ring {</p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc" class="pe-3">
                                    7
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;std <span class="dk_code_org">: :</span> atomic_uint32_t shared_write_pointer __attribute__( ( aligned ( CACHELINE_SIZE ) ) );</p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc" class="pe-3">
                                    8
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;std <span class="dk_code_org">: :</span> atomic_uint32_t shared_read_pointer __attribute__ ( ( aligned ( CACHELINE_SIZE ) ) );</p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc" class="pe-3">
                                    9
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="dk_code_blue">unsigned</span> sender_write_pointer __attribute__( ( aligned ( CACHELINE_SIZE ) ) );</p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc; padding-right: 7px;" class="">
                                    10
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="dk_code_blue">unsigned</span> sender_read_pointer __attribute__( ( aligned ( CACHELINE_SIZE ) ) ) ;</p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc; padding-right: 7px;" class="">
                                    11
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="dk_code_blue">unsigned</span> receiver_write_pointer __attribute__( ( aligned ( CACHELINE_SIZE ) ) ) ;</p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc; padding-right: 7px;" class="">
                                    12
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="dk_code_blue">unsigned</span> receiver_read_pointer __attribute__ ( ( aligned ( CACHELINE_SIZE ) ) )</p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc; padding-right: 7px;" class="">
                                    13
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="dk_code_blue">unsigned</span> ring_size __attribute__( ( aligned( CACHELINE_SIZE ) ) );</p>

                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc; padding-right: 7px;" class="">
                                    14
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;message_t <span class="dk_code_org">*</span>ring __attribute__( ( aligned ( CACHELINE_SIZE ) ) );</p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-bottom: 0rem !important; padding-top: 0rem !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc" class="pe-3">
                                    15
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0"></p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc" class="pe-3">
                                    16
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0"><span class="dk_code_blue">public</span> <span class="dk_code_org">:</span></p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc" class="pe-3">
                                    17
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Ring ( <span class="dk_code_blue">unsigned</span> size )</p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc" class="pe-3">
                                    18
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc" class="pe-3">
                                    19
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ring_size <span class="dk_code_org">=</span> size ;</p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc" class="pe-3">
                                    20
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;shared_write_pointer.store ( <span class="dk_code_blue">0</span> ) ;
                                        </p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc" class="pe-3">
                                    21
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;shared_read_pointer.store ( <span class="dk_code_blue">0</span> ) ;</p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc" class="pe-3">
                                    22
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sender_write_pointer <span class="dk_code_org">=</span> <span class="dk_code_blue">0</span> ;</p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc" class="pe-3">
                                    23
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sender_read_pointer <span class="dk_code_org">=</span> <span class="dk_code_blue">0</span> ;</p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc; padding-right: 7px;" class="">
                                    24
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;receiver_write_pointer <span class="dk_code_org">=</span> <span class="dk_code_blue">0</span> ;</p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc; padding-right: 7px;" class="">
                                    25
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;receiver_read_pointer <span class="dk_code_org">=</span> <span class="dk_code_blue">0</span> ;</p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc; padding-right: 7px;" class="">
                                    26
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ring <span class="dk_code_org">=</span> ( message_t <span class="dk_code_org">*</span> ) aligned_alloc ( CACHELINE_SIZE, ring_size <span class="dk_code_org">*</span> sizeof( message_t ) ) ;</p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc; padding-right: 7px;" class="">
                                    27
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assert ( ring ) ;</p>

                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc; padding-right: 7px;" class="">
                                    28
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="dk_code_blue">for</span> ( <span class="dk_code_blue">unsigned</span> i <span class="dk_code_org">=</span> <span class="dk_code_blue">0</span> ; i <span class="dk_code_org"><</span> ring_size; i <span class="dk_code_org">+=</span> <span class="dk_code_blue">1</span> ) ring [ i ] .sequence .store ( <span class="dk_code_blue">0</span> <span class="dk_code_org">-</span> ring_size ) ;</p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-bottom: 0rem !important; padding-top: 0rem !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc" class="pe-3">
                                    29
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc" class="pe-3">
                                    30
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0"></p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc" class="pe-3">
                                    31
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="dk_code_org">~</span> Ring()</p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc" class="pe-3">
                                    32
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc" class="pe-3">
                                    33
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;free ( ring ) ;</p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc" class="pe-3">
                                    34
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ring <span class="dk_code_org">=</span> <span class="dk_code_blue">NULL</span> ;</p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc" class="pe-3">
                                    35
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc" class="pe-3">
                                    36
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0"></p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc" class="pe-3">
                                    37
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="dk_code_blue">void </span> send ( message_t <span class="dk_code_org">&</span>msg )</p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc; padding-right: 7px;" class="">
                                    38
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc; padding-right: 7px;" class="">
                                    39
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="dk_code_blue">enddo</span></p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc; padding-right: 7px;" class="">
                                    40
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="dk_code_blue">enddo</span></p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc; padding-right: 7px;" class="">
                                    41
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0"> <span class="dk_code_blue">enddo</span></p>

                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc; padding-right: 7px;" class="">
                                    42
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0"> <span class="dk_code_blue">end &nbsp;subroutine</span>  </p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc; padding-right: 7px;" class="">
                                    43
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0"> <span class="dk_code_blue">enddo</span></p>

                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc; padding-right: 7px;" class="">
                                    44
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0"> <span class="dk_code_blue">end &nbsp;subroutine</span>  </p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-bottom: 0rem !important; padding-top: 0rem !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc" class="pe-3">
                                    45
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0"><span class="dk_code_blue">subroutine</span>&nbsp;compute ( a , b , c , d , n )</p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc" class="pe-3">
                                    46
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0"><span class="dk_code_blue">real<span class="dk_code_org"> * </span>8</span> &nbsp;  a ( n , n )</p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc" class="pe-3">
                                    47
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0"><span class="dk_code_blue">real<span class="dk_code_org"> * </span>8</span> &nbsp;  b ( n , n )</p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc" class="pe-3">
                                    48
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0"><span class="dk_code_blue">real<span class="dk_code_org"> * </span>8</span> &nbsp;  c ( n , n )</p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc" class="pe-3">
                                    49
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0"><span class="dk_code_blue">real<span class="dk_code_org"> * </span>8</span> &nbsp;  d ( n , n )</p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc" class="pe-3">
                                    50
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0"><span class="dk_code_blue">do</span> &nbsp;  k <span class="dk_code_org">=</span> <span class="dk_code_blue">1</span> , n</p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc" class="pe-3">
                                    51
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="dk_code_blue">do</span> &nbsp;  j <span class="dk_code_org">=</span> <span class="dk_code_blue">1</span> , n</p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc" class="pe-3">
                                    52
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="dk_code_blue">if</span>  ( j <span class="dk_code_org">. lt .</span> k ) d (k , j ) <span class="dk_code_org">=</span> d ( j , k )</p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc" class="pe-3">
                                    53
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="dk_code_blue">do</span> i <span class="dk_code_org">=</span> j , n</p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc; padding-right: 7px;" class="">
                                    54
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  c ( j , i ) <span class="dk_code_org">=</span>  c ( j , i ) <span class="dk_code_org">+</span>  a ( i , k ) <span class="dk_code_org">*</span>  b ( k , j )</p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc; padding-right: 7px;" class="">
                                    55
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="dk_code_blue">enddo</span></p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc; padding-right: 7px;" class="">
                                    56
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="dk_code_blue">enddo</span></p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc; padding-right: 7px;" class="">
                                    57
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0"> <span class="dk_code_blue">enddo</span></p>

                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc; padding-right: 7px;" class="">
                                    58
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0"> <span class="dk_code_blue">end &nbsp;subroutine</span>  </p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc; padding-right: 7px;" class="">
                                    59
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0"> <span class="dk_code_blue">end &nbsp;subroutine</span>  </p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc; padding-right: 7px;" class="">
                                    60
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0"> <span class="dk_code_blue">end &nbsp;subroutine</span>  </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <p><strong>Figure 2:</strong> Nested Loop Impacting Optimization</p>
                    <p>As an example, consider the Fortran code in Figure 2.&nbsp; The programmer has placed two unrelated computations inside the same loop nest, perhaps thinking this will be more efficient than having two sets of loops. &nbsp;Suppose we compile the code with:</p>

                     <!-- code toolbar 3 -->
                     <div class="mv_code_toolbar" style="margin: 0rem 0rem !important; padding-bottom: 1rem;">
                        <div class="mv_toolbar_item mv_copy_icon">
                            <i class="fa-regular fa-copy"></i>
                        </div>
                        <div class="mv_copy_message text-end hidden">Copied</div>
                        <div class="code-content">
                            <div style="padding-bottom: 0rem !important; padding-left: 0rem !important;" class="d-flex mv_pre">
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0">ifx  -c &nbsp;-xAVX2 &nbsp;-qopt-report=3  paper2. f90 &nbsp;-qopt-report-phase=loop</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <p class="mt-3">The optimization report will contain an advice remark:</p>

                    <!-- code toolbar 3 -->
                    <div class="mv_code_toolbar" style="margin: 0rem 0rem !important; padding-bottom: 1rem;">
                        <div class="mv_toolbar_item mv_copy_icon">
                            <i class="fa-regular fa-copy"></i>
                        </div>
                        <div class="mv_copy_message text-end hidden">Copied</div>
                        <div class="code-content">
                            <div style="padding-bottom: 0rem !important; padding-left: 0rem !important;" class="d-flex mv_pre">
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0">LOOP BEGIN at paper2.f90 &nbsp;(6, 7) <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  remark #25445: Loop interchange not done due to: non-perfect loopnest<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  remark #25451: Advice: Loop interchange, if possible, might help loopnest. <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Suggested Permutation: ( 1 2 3 ) --> ( 3 2 1 )</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <p>This explains that the outermost and innermost induction variables could be interchanged to produce better locality.&nbsp; However, the control flow inside the loop due to the IF statement prevents the compiler from doing this.&nbsp; After a little thought, the programmer can rewrite this code, as shown in Figure 3.&nbsp;</p>
                    <!-- code toolbar 3 -->
                    <div class="mv_code_toolbar">
                        <div class="mv_toolbar_item mv_copy_icon">
                            <i class="fa-regular fa-copy"></i>
                        </div>
                        <div class="mv_copy_message text-end hidden">Copied</div>
                        <div class="code-content">
                            <div style="padding-bottom: 0rem !important" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc" class="pe-3">
                                    1
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0"><span class="dk_code_blue">subroutine</span>&nbsp;compute ( a , b , c , d , n )</p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc" class="pe-3">
                                    2
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0"><span class="dk_code_blue">real<span class="dk_code_org"> * </span>8</span> &nbsp;  a ( n , n )</p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc" class="pe-3">
                                    3
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0"><span class="dk_code_blue">real<span class="dk_code_org"> * </span>8</span> &nbsp;  b ( n , n )</p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc" class="pe-3">
                                    4
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0"><span class="dk_code_blue">real<span class="dk_code_org"> * </span>8</span> &nbsp;  c ( n , n )</p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc" class="pe-3">
                                    5
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0"><span class="dk_code_blue">real<span class="dk_code_org"> * </span>8</span> &nbsp;  d ( n , n )</p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc" class="pe-3">
                                    6
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0"><span class="dk_code_blue">do</span> &nbsp;  k <span class="dk_code_org">=</span> <span class="dk_code_blue">1</span> , n</p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc" class="pe-3">
                                    7
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="dk_code_blue">do</span> &nbsp;  j <span class="dk_code_org">=</span> <span class="dk_code_blue">1</span> , n</p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc" class="pe-3">
                                    8
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="dk_code_blue">if</span>  ( j <span class="dk_code_org">. lt .</span> k ) d (k , j ) <span class="dk_code_org">=</span> d ( j , k )</p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc" class="pe-3">
                                    9
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="dk_code_blue">enddo</span></p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc; padding-right: 7px;" class="">
                                    10
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0"> <span class="dk_code_blue">enddo</span></p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc; padding-right: 7px;" class="">
                                    11
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0"><span class="dk_code_blue">do</span> &nbsp;  k <span class="dk_code_org">=</span> <span class="dk_code_blue">1</span> , n</p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc; padding-right: 7px;" class="">
                                    12
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="dk_code_blue">do</span> &nbsp;  j <span class="dk_code_org">=</span> <span class="dk_code_blue">1</span> , n</p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc; padding-right: 7px;" class="">
                                    13
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="dk_code_blue">do</span> &nbsp;  i <span class="dk_code_org">=</span> <span class="dk_code_blue">1</span> , n</p>

                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc; padding-right: 7px;" class="">
                                    14
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c ( j , i ) <span class="dk_code_org">=</span> c ( j , i ) <span class="dk_code_org">+</span> a ( i , k ) <span class="dk_code_org">*</span> b ( k , j )</p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc; padding-right: 7px;" class="">
                                    15
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="dk_code_blue">enddo</span>  </p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc; padding-right: 7px;" class="">
                                    16
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="dk_code_blue">enddo</span>  </p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important; padding-bottom: 0px !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc; padding-right: 7px;" class="">
                                    17
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0"> <span class="dk_code_blue">enddo</span>  </p>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top: 0rem !important;" class="d-flex mv_pre">
                                <div style="border-right: 1px solid #ccc; padding-right: 7px;" class="">
                                    18
                                </div>
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0"> <span class="dk_code_blue">end &nbsp;subroutine</span>  </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <p><strong>Figure 3:</strong> Nested Loop Resolved, Making Optimization Easier</p>
                    <p>Compiling this version of the code in the same manner shows that the compiler can now perform the loop interchange optimization on the second loop.</p>

                    <!-- code toolbar 3 -->
                    <div class="mv_code_toolbar" style="margin: 0rem 0rem !important; padding-bottom: 1rem;">
                        <div class="mv_toolbar_item mv_copy_icon">
                            <i class="fa-regular fa-copy"></i>
                        </div>
                        <div class="mv_copy_message text-end hidden">Copied</div>
                        <div class="code-content">
                            <div style="padding-bottom: 0rem !important; padding-left: 0rem !important;" class="d-flex mv_pre">
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0">LOOP BEGIN &nbsp;at&nbsp; paper2a.f90 &nbsp;( 12 , 10 ) <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  remark #25444: Loop nest interchanged: ( 1 2 3 ) --> ( 3 2 1 )</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <p>The optimizer can also point out when a group of memory references has poor spatial locality; that is, each subsequent reference is far away from the previous one.&nbsp; It can tell you when memory references aren’t known to be distinct or may involve phantom data dependencies that you can fix with annotations in your source code.&nbsp; When a loop nest is optimized to operate on blocks of memory to improve locality, remarks in the optimization report will indicate how to best tune the blocking factors.&nbsp; Finally, when the optimizer chooses to perform the unroll-and-jam optimization, it emits remarks into the report explaining how you can either suppress the optimization or tune it for better performance.</p>

                    <p>Writing optimal loop nests can be quite difficult, so look out for these advisory remarks and consider whether you can make suggested changes to improve your code’s performance. The optimizer may not have enough information to make these changes safely, so providing these remarks is the next best thing.</p>
                    </section>


                    <section id="dk_improvement_vectori">
                        <h4>Improvements to Vectorization Reports</h3>
                            <p>The OpenMP standard allows the creation of vectorized functions by specifying <span style="background-color: #e6e6e6;">#pragma omp declare simd</span> ahead of the function implementation.&nbsp; The oneAPI compiler optimization report now includes a section describing the function vectorization.&nbsp; This looks very much like the report you will see for loop vectorization but wrapped in a FUNCTION block instead of a LOOP block.&nbsp; It is possible to create more than one vectorized version of a function (for instance, using 256-bit vectors versus 512-bit vectors), and there is a separate report section for each such version.</p>
                            <p>The vectorizer now provides more information about memory references in vectorized code.&nbsp; At the highest verbosity level, the optimization report will include a remark for each vectorized reference, describing whether the reference is aligned on a vector boundary and/or masked and providing source location information (<span style="background-color: #e6e6e6;">line:column</span>) for the reference.&nbsp; When the <span style="background-color: #e6e6e6;">-g</span> option is selected, the vectorizer will also include limited name information for the memory reference in question. &nbsp;&nbsp;</p>
                        <p>For example:</p>

                        <!-- code toolbar 3 -->
                    <div class="mv_code_toolbar" style="margin: 0rem 0rem !important; padding-bottom: 1rem;">
                        <div class="mv_toolbar_item mv_copy_icon">
                            <i class="fa-regular fa-copy"></i>
                        </div>
                        <div class="mv_copy_message text-end hidden">Copied</div>
                        <div class="code-content">
                            <div style="padding-bottom: 0rem !important; padding-left: 0rem !important;" class="d-flex mv_pre">
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0">LOOP BEGIN &nbsp;at&nbsp; test.c ( 2 , 3 ) <br>
                                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;remark #15389 : &nbsp; vectorization support : &nbsp;unmasked unaligned unit stride load : &nbsp; A ( 4 : 12 ) <br> 
                                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;remark #15389 : &nbsp; vectorization support : &nbsp;unmasked unaligned unit stride load : &nbsp; A ( 3 : 19 ) <br>
                                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;remark #15388 : &nbsp; vectorization support : &nbsp;unmasked aligned unit stride store : &nbsp; B ( 3 : 10 )
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <p class="mt-3">Here, the array names A and B appear only when <span style="background-color: #e6e6e6;">-g</span> is selected on the command line; otherwise, the available debug information is insufficient to produce array name information.&nbsp; Be sure to compile for debug if you want to see this information!</p>
                    <p>The vectorizer can also optimize groups of nearby memory references to use wide loads and shuffles instead of a gather load (and similarly for stores).&nbsp; The optimization report now includes remarks for this VLS (vector load/store) optimization.&nbsp; An example of this:</p>

                       <!-- code toolbar 3 -->
                       <div class="mv_code_toolbar" style="margin: 0rem 0rem !important; padding-bottom: 1rem;">
                        <div class="mv_toolbar_item mv_copy_icon">
                            <i class="fa-regular fa-copy"></i>
                        </div>
                        <div class="mv_copy_message text-end hidden">Copied</div>
                        <div class="code-content">
                            <div style="padding-bottom: 0rem !important; padding-left: 0rem !important;" class="d-flex mv_pre">
                                <div class="">
                                    <div class="mv_code text-break">
                                        <p class="mb-0">LOOP BEGIN &nbsp;at&nbsp; test.c ( 6 , 3 ) <br>
                                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;remark #15300: LOOP WAS VECTORIZED <br>
                                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;remark #15305: vectorization support: vector length 4<br>
                                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;remark #15597: -- VLS-optimized vector load replaces 3 independent loads of stride 3<br>
                                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;remark #15598 :&nbsp; load #1 &nbsp; from :&nbsp; arr1 [&nbsp; test1.c &nbsp; (9, 11)&nbsp;]<br>
                                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;remark #15598 :&nbsp; load #2 &nbsp; from :&nbsp; arr1 [&nbsp; test1.c &nbsp; (7, 10)&nbsp;]<br>
                                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;remark #15598 :&nbsp; load #3 &nbsp; from :&nbsp; arr1 [&nbsp; test1.c &nbsp; (8, 11)&nbsp;]<br>
                                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;remark #15600 :&nbsp; -- end VLS-optimized group<br>
                                            LOOP END
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <p>A few other minor remarks have been added, and previously noted problems with ordering vectorized loops in the report have been corrected.&nbsp; Finally, the remark numbers for the vectorization report have been corrected to always match those from the Intel Compilers Classic where a match exists to ease porting of tools that relied on the existing remark numbers.</p>
                    </section>

                    
                    <section id="dk_improvement_openmp_reports">
                        <h4>Improvements to OpenMP Reports</h4>
                        <p>The compiler now produces two separate optimization reports for OpenMP when an offload target is specified.&nbsp; The host optimization report is named <span style="background-color: #e6e6e6;">myfile.optrpt</span>, as usual.&nbsp; The device optimization report has a name derived from the selected target.&nbsp; For example, if <span style="background-color: #e6e6e6;">-fopenmp-targets=spir64</span> is specified, the name of the target report is <span style="background-color: #e6e6e6;">myfile-openmp-spir64.optrpt</span>.&nbsp; Furthermore, the contents of the target report include a banner emphasizing that the report is for offloaded device code.</p>
                        <p>The NAMED clause from OpenMP directives is now used wherever possible within the optimization report, providing source name information for clarity.&nbsp; This includes usage for map names and shared privatization.&nbsp; Map clauses implicitly generated by the compiler, rather than explicitly specified on an OpenMP directive, are identified as such.</p>
                        <p>Several new remarks have been added for both host-side and device-side optimization reports.&nbsp; These include remarks about transformations performed on loop constructs, remarks about loops running on the device, remarks identifying kernel local variables assigned to stack memory, and remarks about loop collapsing.&nbsp; The report has been divided into sections for clarity, similar to how the Intel Compilers Classic generated the reports.</p>
                    </section>

                    <section id="dk_improvements_code">
                        <h4>Improvements to Code Generation Reports</h4>
                        <p>The code generation section of the optimization report was empty before release 2025.0. Now, it includes a register allocation report that identifies registers used by the function, callee-save registers saved on the stack, and other information about function stack usage.</p>
                    </section>
                    <p class="mb-0">&nbsp;</p> 

                    <section id="dk_looking_forward">
                        <h3 style="font-weight: 300;">Looking Forward</h3>
                        <p>The optimization reports produced by the Intel oneAPI compilers are intended to help our users understand how their code has been optimized and to stimulate ideas for rewriting code for better performance.&nbsp; With the release of 2025.0, we brought these reports up to the Intel Compilers Classic standards and improved them beyond those expectations.&nbsp; This is an ongoing project. We have many more improvements planned for future releases.</p>
                        <p>We would like to hear from those of you using the optimization reports.&nbsp; Ideas for additional improvements are most welcome! Let us know any extra compiler optimization guidance that could benefit your software development, by submitting your feedback in our community forums for the <a href="" style="color:#0563c1; text-decoration:underline !important">Intel® oneAPI DPC++/C++ Compiler</a> and <a href="" style="color:#0563c1; text-decoration:underline !important">Intel® Fortran Compiler</a>.</p>
                    </section>
                    <p class="mb-0">&nbsp;</p> 

                    <section id="dk_download_compailers">
                        <h3 style="font-weight: 300;">Download the Compilers Now</h3>
                        <p>You can download the&nbsp;<a href="" style="color:#0563c1; text-decoration:underline !important">Intel oneAPI DPC++/C++ Compiler</a>&nbsp;and the <a href="" style="color:#0563c1; text-decoration:underline !important">Intel® Fortran Compiler</a> on Intel’s&nbsp;<a href="" style="color:#0563c1; text-decoration:underline !important">oneAPI Developer Tools product page</a>.&nbsp;</p>
                        <p>This version is also in&nbsp;the <a href="" style="color:#0563c1; text-decoration:underline !important">Intel® Toolkits</a>, which include an advanced set of foundational tools, libraries, analysis, debug and code migration tools.</p>
                        <p>You may also want to check out our contributions to the LLVM compiler project on&nbsp;<a href="" style="color:#0563c1; text-decoration:underline !important">GitHub</a>.</p>
                    </section>
                    <p class="mb-0">&nbsp;</p> 

                    <section id="dk_additional_resou">
                        <h3 style="font-weight: 300;">Additional Resources</h3>
                        <ul>
                            <li><a class="b_special_a1" href="">oneAPI 2025.0 Release - Boost Developer Productity for AI and Open Accelerated Computing</a>&nbsp;&nbsp;</li>
                            <li><a class="b_special_a1" href="">DPC++/C++ Developer Guide and Reference</a>&nbsp;</li>
                            <li><a class="b_special_a1" href="">Fortran Developer Guide and Reference</a>&nbsp;</li>
                            <li>Hardware Profile-Guided Optimization
                            <ul style="list-style-type:circle">
                                <li><a href="" style="color:#0563c1; text-decoration:underline !important">Technical Article</a></li>
                                <li><a href="" style="color:#0563c1; text-decoration:underline !important">DPC++ Developer Guide and Reference</a>&nbsp;</li>
                            </ul>
                            </li>
                            <li><a href="" style="color:#0563c1; text-decoration:underline !important">oneAPI GPU Optimization Guide</a>&nbsp;</li>
                            <li><a href="" style="color:#0563c1; text-decoration:underline !important">Find Bugs Quickly Using Sanitizers with the Intel® oneAPI DPC++/C++ Compiler</a></li>
                            <li><a href="" style="color:#0563c1; text-decoration:underline !important">LLVM-based Projects from Intel</a></li>
                        </ul>
                    </section>
                    <p class="mb-0">&nbsp;</p> 

                    <section id="dk_get_help">
                        <h3 style="font-weight: 300;">Get Help</h3>
                        <p class="mb-0">Your success is our success. Access this support resource when you need assistance.</p>
                        <ul>
                            <li><a href="" style="color:#0563c1; text-decoration:underline !important">Intel Fortran Compiler Forum</a></li>
                            <li><a href="" style="color:#0563c1; text-decoration:underline !important">Intel oneAPI DPC++/C++ Compiler Forum</a></li>
                            <li>For additional help, see our general&nbsp;<a href="" style="color:#0563c1; text-decoration:underline !important">oneAPI Support</a>.</li>
                        </ul>
                    </section>
                        
                    </section>
                </div>
            </div>
        </div>
    </section>


  
    

     <section style="border-top: 1px solid #d7d7d7;" class="container py-5">
        <h4 class="h6">Product and Performance Information</h4>
        <div class="disclaimer" style="font-size: 12px;"><sup>1</sup> Performance varies by use, configuration and other factors. Learn more at <a class="b_special_a1" href="">www.Intel.com/PerformanceIndex</a>.</div>
        </div>
    </section>

    <!-- footer -->
    <div id="footer"></div>

    <!-- script header and footer -->
    <script>
        // navbar include  
        fetch('/y_index/y_navbar.html')
            .then(response => response.text())
            .then(data => {
                document.getElementById('navbar').innerHTML = data;
            });
        // footer include 
        fetch('/y_index/y_footer.html')
            .then(response => response.text())
            .then(data => {
                document.getElementById('footer').innerHTML = data;
            });
    </script>

    <!-- nav script -->
    <script>
        document.addEventListener('DOMContentLoaded', function () {
        if (document.getElementsByClassName('VK_all_sections section') && document.getElementsByClassName('VK_sidebar_dropdown')) {
            const sections = document.querySelectorAll('.VK_all_sections section');
            const navLinks = document.querySelectorAll('.VK_sidebar_dropdown a');
            const detailsElements = document.querySelectorAll('.VK_sidebar_dropdown details');

            function removeActiveClass() {
                navLinks.forEach(link => link.classList.remove('VK_sidebar_active_link'));
                detailsElements.forEach(details => {
                    details.removeAttribute('open');
                    details.setAttribute('close', ''); // Optional: to visually indicate it's closed
                });
            }

            function activateLinkAndDetails(targetId) {
                navLinks.forEach(link => {
                    if (link.getAttribute('href') === `#${targetId}`) {
                        link.classList.add('VK_sidebar_active_link');
                        let parentDetails = link.closest('details');

                        // Open all ancestor details elements
                        while (parentDetails) {
                            parentDetails.setAttribute('open', '');
                            parentDetails.removeAttribute('close'); // Optional: remove the closed indicator
                            parentDetails = parentDetails.parentElement.closest('details');
                        }
                    }
                });
            }

            function onScroll() {
                let currentSection = '';
                sections.forEach(section => {
                    const sectionTop = section.getBoundingClientRect().top;
                    const sectionBottom = section.getBoundingClientRect().bottom;

                    // Check if the section is in view
                    if (sectionTop <= 100 && sectionBottom >= 0) {
                        currentSection = section.getAttribute('id');
                    }
                });

                if (currentSection) {
                    removeActiveClass();
                    activateLinkAndDetails(currentSection);
                } else {
                    removeActiveClass();
                }
            }

            window.addEventListener('scroll', onScroll);
        } else {
            return
        }
    });
    </script>

    <!-- copy script -->
    <script>
        document.addEventListener("DOMContentLoaded", () => {
            document.querySelectorAll(".mv_copy_icon").forEach((icon) => {
                icon.addEventListener("click", async function () {
                    try {
                        const toolbar = this.closest(".mv_code_toolbar");
                        const codeBlock = toolbar.querySelector(".code-content");
                        const codeContent = codeBlock.innerText;
    
                        // Use Clipboard API to copy text
                        await navigator.clipboard.writeText(codeContent);
    
                        // Hide the copy icon and show the "Copied!" message
                        const message = toolbar.querySelector(".mv_copy_message");
                        this.classList.add("hidden"); // Hide the copy icon
                        message.classList.remove("hidden"); // Show the "Copied!" message
    
                        // Hide the message and show the icon again after 2 seconds
                        setTimeout(() => {
                            message.classList.add("hidden");
                            this.classList.remove("hidden");
                        }, 2000); // Adjust delay as needed
    
                    } catch (err) {
                        console.error('Failed to copy text: ', err);
                    }
                });
            });
        });
    </script>

</body>

</html>