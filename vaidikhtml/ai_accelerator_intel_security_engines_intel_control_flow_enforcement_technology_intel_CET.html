<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Intel Control-flow Enforcement Technology (Intel CET)</title>

    <link rel="stylesheet" href="../css/mv_ai_accelerator_intel_security_engines_intel_control_flow_enforcement_technology_intel_CET.css">

    <!-- header footer -->
    <link rel="stylesheet" href='/css/yatri.css'>
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
        crossorigin="anonymous"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" rel="stylesheet">
</head>
<body>

    <!-- header -->
    <div id="navbar"></div>

    <!-- Intel AMX ? -->
    <section>
        <div class="mv_intel_amx_bg_color">
            <div class="container">
                <div class="row mv_intel_amx_content">
                    <div class="col-sm-12 mv_intel_amx_item">
                        <div class="mv_intel_amx">
                            <h3>A Technical Look at Intel’s Control-flow Enforcement Technology</h3>
                            <h5 style="margin-top: 1.5rem;">Custom-trained large language models can run faster when they run on Intel<sup>®</sup> Xeon<sup>®</sup> CPU Max Series processors with HBM.</h5>
                        </div>
                    </div>
                </div>
                <div class="mv_cd_page_marquee_info">
                    <div class="mv_cd_page_marquee_action">
                        <div class="mv_cd_page_marquee_action_padd">
                            <label for="">ID</label>
                            <span>660329</span>
                        </div>
                        <div class="mv_cd_page_marquee_action_padd">
                            <label for="">Updated</label>
                            <span>6/13/2020</span>
                        </div>
                        <div class="mv_cd_page_marquee_action_padd">
                            <label for="">Version</label>
                            <span>Latest</span>
                        </div>
                        <div class="mv_cd_page_marquee_action_padd">
                            <span>Public</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section class="container py-5">
        <div class="row">
            <div class="d-flex justify-content-end col-xl-10 py-3 d-md-none">   
                <i class="fa-solid fa-print fs-4 px-2 " style="color:#0068B5"></i>
                <i class="fa-regular fa-envelope fs-4 px-2" style="color:#0068B5"></i>
            </div>
            <div class="col-lg-3 col-md-4">
                
            </div>
            <div class="col-lg-9 col-md-8" >
                <div class="d-md-flex justify-content-end col-xl-10 py-3 d-none">
                    <i class="fa-solid fa-print fs-4 px-2 " style="color:#0068B5"></i>
                    <i class="fa-regular fa-envelope fs-4 px-2" style="color:#0068B5"></i>
                </div>
                <div class="col-xl-10">
                    <section style="padding-bottom: 16px;">
                        <p class="mb-0">&nbsp;</p>
                        <div class="text-center">
                            <strong>Intel Fellow Client Computing Group</strong>
                        </div>
                        <p class="mb-0">&nbsp;</p>
                        <p> 
                            Intel has a long history of working with the software community and making strides in strengthening protections of operating systems and software running on modern computer systems. As these protections came into effect, adversaries started looking for creative alternatives to bypass these protections. Return Oriented Programming (also known as ROP) and Jump Oriented Programming (also known as JOP) are two such techniques that has been gaining popularity. JOP or ROP attacks can be particularly hard to detect or prevent because the attacker uses existing code running from executable memory in a creative way to change program behavior. What makes it hard to detect or prevent ROP/JOP is the fact that attacker uses existing code running from executable memory. Many software-based detection and prevention techniques have been developed and deployed with limited success. 
                        </p>
                        <p class="mb-0">
                            ROP is where the attacker relies on RET (return) instruction to stitch together a malicious code flow that was not programmer-intended. Per the design, return instructions fetch the address of next instruction from stack (which was pushed on the stack by the prior CALL instruction) and executes instructions from that address. In the case of ROP-based attacks, the attacker apriori or at runtime scans for sequence of bytes in existing program code by scanning the program on disk or in memory. Figure 1 shows an example of existing instruction stream.
                        </p>
                    </section>
                    <section>
                        <div class="text-center">
                            <strong>Figure 1</strong>
                        </div>
                        <div class="mv_speedup_image">
                            <p>
                                <img src="/img/mv_image/cet-instruction-stream.jpg" alt="">
                            </p>
                        </div>
                        <p>
                            This example shows three instructions executed in a sequence (notice there are no RET instructions in this programmer-intended sequence) and corresponding bytes of program in blue boxes below. The same set of code bytes, when interpreted starting at an invalid offset, can also mean alternate set of instructions that cause the sequence to end with a RET as shown in the figure below where bytes in red boxes correspond to a different instruction sequence and in this example, each instruction is followed by C3 which corresponds to the return instruction. These instruction sequences are called “gadgets”.
                        </p>
                        <p class="mb-0">&nbsp;</p>
                    </section>
                    <section>
                        <div class="text-center">
                            <strong>Figure 1</strong>
                        </div>
                        <div class="mv_speedup_image">
                            <p>
                                <img src="/img/mv_image/cet-gadgets.jpg" alt="">
                            </p>
                        </div>
                        <p>
                            By carefully placing starting addresses of these alternate instruction-sets or “gadgets” that are all terminated by the ret instruction, the attacker can execute arbitrary attack code flows that were not intended in the original program using already-executable bytes of the original program. So, with a ROP attack, the attacker can execute arbitrary code composed via gadgets using the existing program inheriting all the permissions of the program. This makes these attacks effective and hard to detect and potentially allow an attacker to escalate privileges or break out of process sandboxes. These types of malware target operating systems (OS), browsers, readers and many other applications, and it takes deep integration with hardware at the foundation to deliver more effective protection with minimal performance impact.
                        </p>
                        <p>
                            Since ROP relies on RET instructions, where the address of the next instruction to execute is fetched from a stack, stack corruption plays a critical role in ROP attacks. CET enables the OS to create a Shadow Stack, which is designed to be protected from application code memory accesses, and stores CPU-stored copies of the return addresses. This helps ensure that even when an attacker is able to modify/corrupt the return addresses in the data stack for the purpose of carrying out a ROP attack, the attacker is not able to modify the Shadow Stack, and the CET state machine in the CPU detects mismatches between the address on the shadow and data stack to help prevent the attack via an exception reported to the OS.
                        </p>
                        <p>
                            Similarly, other indirect branch instructions, such as Call and Jump indirect can be used to launch variant attacks - called COP (call oriented programming) or JOP (jump oriented programming). CET also adds an Indirect Branch Tracking capability to provide software the ability to restrict COP/JOP attacks.
                        </p>
                        <p>
                            Intel has been actively collaborating with Microsoft and other industry partners to address control-flow hijacking by using Intel’s CET technology to augment the previous software-only control-flow integrity solutions. Intel’s CET, when used properly by software, is a big step in helping to prevent exploits from hijacking the control-flow transfer instructions. For more details, reference Microsoft’s BLOG <a class="b_special_a1" href="">“Understanding Hardware-enforced Stack Protection”</a>. 
                        </p>
                    </section>
                    <section>
                        <h3 style="font-weight: 350; margin: 2.5rem 0 11px;">Reference Links</h3>
                        <p class="mb-0"><a class="b_special_a1" href="">Security Analysis of Processor Instruction Set Architecture for Enforcing Control-Flow Integrity (ACM Digital Library)</a></p>
                        <p class="mb-0"><a class="b_special_a1" href="">Paper PDF</a></p>
                        <p class="mb-0"><a class="b_special_a1" href="">Intel Software Development Emulating (SDE)</a></p>
                        <p class="mb-0"><a class="b_special_a1" href="">Intel Compiler</a></p>
                        <p class="mb-0"><a class="b_special_a1" href="">GCC Instrumentation Options</a></p>
                        <div>
                            <strong>Linux Kernel Patches</strong>
                        </div>
                        <ul>
                            <li><a class="b_special_a1" href="">Intel CET Support Still Getting Squared Away For Linux In 2020</a></li>
                            <li><a class="b_special_a1" href="">Control-flow Enforcement: Shadow Stack</a></li>
                        </ul>
                    </section>
                </div>
            </div>
        </div>
    </section>

    <!-- noticed -->
    <section style="border-top: 1px solid #d7d7d7;" class="container py-5">
        <h4 class="h6">Product and Performance Information</h4>
        <div class="disclaimer" style="font-size: 12px;"><sup>1</sup> Performance varies by use, configuration and other factors. Learn more at <a class="b_special_a1" href="">www.Intel.com/PerformanceIndex</a>.</div>
    </section>

    <!-- footer -->
    <div id="footer"></div>

    <!-- script header and footer -->
    <script>
        // navbar include  
        fetch('/y_index/y_navbar.html')
            .then(response => response.text())
            .then(data => {
                document.getElementById('navbar').innerHTML = data;
            });
        // footer include 
        fetch('/y_index/y_footer.html')
            .then(response => response.text())
            .then(data => {
                document.getElementById('footer').innerHTML = data;
            });
    </script>

    <!-- nav script -->
    <script>
        document.addEventListener('DOMContentLoaded', function () {
        const nav = document.querySelector('.VK_client_app_navigation');
        const navLinks = document.querySelectorAll('.VK_ai_nav_bar a');
        const sections = document.querySelectorAll('section[id]');
        let navOffset = nav.offsetTop;

            // Add smooth scrolling to all links
            navLinks.forEach(link => {
                link.addEventListener('click', function (e) {
                    e.preventDefault();
                    document.querySelector(this.getAttribute('href')).scrollIntoView({
                        behavior: 'smooth'
                    });
                });
            });

            // Sticky Navigation
            window.addEventListener('scroll', () => {
                if (window.pageYOffset >= navOffset) {
                    nav.classList.add('VK_sticky_nav_bar');
                } else {
                    nav.classList.remove('VK_sticky_nav_bar');
                }                
                // Section highlighting
                sections.forEach(section => {
                    const sectionTop = section.offsetTop - nav.clientHeight;
                    const sectionHeight = section.clientHeight;
                    console.log(sectionTop);
                    console.log(sectionHeight);
                    if (window.pageYOffset >= sectionTop && window.pageYOffset <= sectionTop + sectionHeight) {
                        navLinks.forEach(link => {
                            link.classList.remove('active');
                            if (link.getAttribute('href') === `#${section.id}`) {
                                link.classList.add('active');
                                
                                // Ensure the active link is visible in the nav bar
                                const navBar = document.querySelector('.VK_ai_nav_bar');
                                const activeLink = document.querySelector('.VK_ai_nav_bar a.active');
                                const linkRect = activeLink.getBoundingClientRect();
                                const navBarRect = navBar.getBoundingClientRect();

                                if (linkRect.left < navBarRect.left || linkRect.right > navBarRect.right) {
                                    activeLink.scrollIntoView({ inline: 'center', behavior: 'smooth' });
                                }
                            }
                        });
                    }
                });
            });
        });
    </script>

</body>
</html>