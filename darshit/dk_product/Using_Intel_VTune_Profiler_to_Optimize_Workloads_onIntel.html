<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Optimize Workloads on Intel® Max Series CPUs & GPUs</title>

    <link rel="stylesheet" href="/css/dk_developer_edge_iot_&_5G_social_distancing_for_retail_settings.css">
    <link rel="stylesheet" href="/css/rushita_automotive.css">
    <!-- header footer -->
    <link rel="stylesheet" href='/css/yatri.css'>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
        crossorigin="anonymous"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" rel="stylesheet">
</head>

<style>
    @media(max-width:768px){
        .mv_intel_amx_content{
            padding-right: 0px !important;
        }
        .dk_high_quality{
            text-align: center;
        }
    }
    @media(max-width:575px){
        .dk_button{
            width: 100% !important;
        }
    }
</style>

<body>

    <!-- header -->
    <div id="navbar"></div>

    <!-- ------------------------------------------------------------------------------->
     <section class="m_ai_tdrop">
        <div>
            <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                Developers
            </button>
            <ul class="dropdown-menu">
                <li><a class="dropdown-item m_dropActive" href="#">Overview</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Topics & Technologies</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Tools</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Resources & Documentation</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Learn</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Community & Events</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Developer Programs</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Get Help</a></li>
            </ul>
        </div>
    
        <div class="m_ai_shlash">/</div>
        <div>
            <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                Tools
            </button>
            <ul class="dropdown-menu">
                <li><a class="dropdown-item m_dropActive" href="#">Software Catalog</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">oneAPI</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Open Edge Platform</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">FPGA</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Intel® Active Management Technology SDK</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Intel® Advisor</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Intel® AI Reference Models</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Intel® Collaboration Suite for WebRTC SDK</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Intel® Tiber™ AI Cloud</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Intel® Distribution for Python*</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Intel® Distribution for GDB*</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Intel® DPC++ Compatibility Tool</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Intel® Dynamic Application Loader</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Frameworks</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Intel® Embree</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Intel® Extension for Scikit-learn*</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Intel® Fortran Compiler</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Intel® Graphics Performance Analyzers</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Intel® Homomorphic Encryption Toolkit</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Intel® In-Band Manageability</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Intel® Integrated Performance Primitives</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Intel® Integrated Simulation Infrastructure with Modeling</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Instruction Set Architecture (ISA) Extensions</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Intel® Intelligent Storage Acceleration Library (Intel® ISA-L)</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Modin*</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Intel® MPI Library</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Intel® Neural Compressor</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">OpenCL™ Runtime</a></li>   
                <li><a class="dropdown-item m_dropActive" href="#">Intel® Open Image Denoise</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Intel® Open Path Guiding Library (Intel® Open PGL)</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Pin</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Intel® Platform Analysis Library</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Intel Tools for OpenCL™ Software</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Intel Tools for OpenCL™ Applications</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Intel® OpenSWR</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">OpenVINO™ Toolkit</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Intel® Open Volume Kernel Library</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Intel® Optimization for XGBoost*</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Intel® OSPRay</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Intel® OSPRay for Hydra*</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Intel® OSPRay Studio</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">PyTorch* Optimizations from Intel</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">TensorFlow* Optimizations from Intel</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Intel® Rendering Toolkit</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Intel® Smart Edge Open</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Intel® Software Guard Extensions</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Intel® Secure Device Onboard</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Intel® Software Development Emulator</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Intel® Quantum SDK</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Intel® Query Processing Library (Intel® QPL)</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Intel® Video Processing Library</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Intel® VTune™ Profiler</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Resellers</a></li>
            </ul>
        </div>

        <div class="m_ai_shlash">/</div>
        <div>
            <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                oneAPI
            </button>
            <ul class="dropdown-menu">
                <li><a class="dropdown-item m_dropActive" href="#">Overview</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Data Parallel C++/SYCL*</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Toolkits</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Tech Articles & How-Tos</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Components</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Code Samples</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Training</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Documentation</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Support</a></li>
            </ul>
        </div>

        <div class="m_ai_shlash">/</div>
        <div>
            <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                Tech Articles & How-Tos
            </button>
            <ul class="dropdown-menu">
                <li><a class="dropdown-item m_dropActive" href="#">Library</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">News Updates</a></li>
                <li><a class="dropdown-item m_dropActive" href="#">Webinars</a></li>
            </ul>
        </div>

        <div class="m_ai_shlash">/</div>
        <div class="m_ai_httl">Optimize Code on CPUs & GPUs with VTune™ Profiler</div>
    </section>  
    <!--------------------------------------------------------------------------------->

    <!-- Social Distancing for Retail Settings -->
    <section>
        <div class="mv_intel_amx_bg_color">
            <div class="container">
                <div class="row mv_intel_amx_content">
                    <div class="col-md-12 col-sm-12 mv_intel_amx_item">
                        <div class="mv_intel_amx">
                            <h2 class="mb-0">Using Intel® VTune™ Profiler to Optimize Workloads on Intel® Max Series CPUs & GPUs</h2>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section class="container py-5">
        <div class="row">
            <div class="d-flex justify-content-end col-xl-10 py-3 d-md-none">
                <i class="fa-solid fa-print fs-4 px-2 " style="color:#0068B5"></i>
                <i class="fa-regular fa-envelope fs-4 px-2" style="color:#0068B5"></i>
            </div>
            <div class="col-lg-3 col-md-4">
                <!-- nav -->
                <div class="VK_sticky_side_bar VK_side_bar_postion_stickey">
                    <div>
                        <div class="VK_sidebar_dropdown">
                            <p class="m-0">
                                <a href="#dk_intel_max_series" class="text-decoration-none VK_a">
                                    Intel® Max Series Processors: Maximizing Memory and Compute for HPC & AI Workloads 
                                </a>
                            </p>                    
                            <details>
                                <summary>
                                    <a href="#dk_intel_vtune" class="text-decoration-none VK_a">
                                        Intel® VTune™ Profiler: One Tool to Optimize Multiple CPU-GPU Workloads
                                    </a>
                                </summary>
                                <ul class="list-unstyled ps-3 mb-0">
                                    <li>
                                        <a href="#dk_will_your"
                                            class="text-decoration-none VK_a my-1">
                                            Will Your Workload Benefit from HBM?
                                        </a>
                                    </li>
                                    <li>
                                        <a href="#dk_bandwidth"
                                            class="text-decoration-none VK_a my-1">
                                            Bandwidth Utilization Histogram
                                        </a>
                                    </li>
                                    <li>
                                        <a href="#dk_timeline_pane"
                                            class="text-decoration-none VK_a my-1">
                                            Timeline Pane
                                        </a>
                                    </li>
                                    <li>
                                        <a href="#dk_how_do_we"
                                            class="text-decoration-none VK_a my-1">
                                            How Do We Ensure Optimal Data Traffic between CPU and GPU?
                                        </a>
                                    </li>
                                </ul>
                            </details>

                        </div>
                    </div>
                </div>
                <!-- thinkcode -->
                <div class="dk_things_code_main">
                    <div class="dk_things_code">
                        <h2 class="text-left headline-font-one-bold">Get the Latest on All Things CODE</h2>
                        <div class="dk_high_quality" style="padding-top: 1rem;">
                            <a class="dk_button" href="">Sign Up</a>
                        </div>
                    </div> 
                    <div class="mt-3">
                        <p class="mb-2"><b>Max Terry,<i> </i></b><i>Developer Tools Product Marketing Manager<b></b></i></p>
                        <p class="mb-2"><b>Danil Korlovskiy,<i> </i></b><i>Intel Analysis Tools Software Engineer</i></p>
                        <p class="mb-2"><b>Vishnu Naikawadi, </b><i>Intel Analysis Tools Software Architect</i></p>
                        <p>Intel Corporation<br></p>
                    </div>
                </div>
            </div>
            <div class="col-lg-9 col-md-8">
                <div class="d-md-flex justify-content-end col-xl-10 py-3 d-none">
                    <i class="fa-solid fa-print fs-4 px-2 " style="color:#0068B5"></i>
                    <i class="fa-regular fa-envelope fs-4 px-2" style="color:#0068B5"></i>
                </div>
                <div class="col-xl-10 VK_all_sections">
                    <p>&nbsp;</p>
                    <h4><strong>Story at a Glance</strong><a class="inpage-nav-anchor" id="-undefined"></a></h4>
                    <ul> 
                        <li>The 2023.1 release of Intel® oneAPI tools included enhancements to <a class="b_special_a1" href="">Intel® VTune™ Profiler</a> that help developers take full advantage of multiarchitecture performance on the Intel® Max Series product family of CPUs and GPUs.</li> 
                        <li>Intel Max Series processors deliver breakthrough performance and unblock bottlenecks for memory-bound workloads that can be challenging for many AI and HPC applications. The CPU is the first and only x86-based processor with high-bandwidth memory (HBM). The GPU packs over 100 billion transistors into a package and contains up to 128 Xe Cores.</li> 
                        <li>Intel VTune Profiler is optimized to help developers identify issues in code running on CPUs, GPUs, and FPGAs. For Max Series CPUs, it includes HBM-specific performance metrics that identify the usage of HBM memory by workload. On Max Series GPUs, VTune Profiler can be used for visibility into Xe Link cross-card traffic; uncover issues such as stack-to-stack traffic, throughput, and bandwidth bottlenecks; and identify imbalances of traffic between CPU and GPU.</li> 
                       </ul>
                    <section id="dk_intel_max_series">
                        <p class="mb-0">&nbsp;</p>
                        <h4 style="font-weight: 350;">Intel® Max Series Processors: Maximizing Memory and Compute for HPC & AI Workloads</h4>
                        <p>There is a large diversity in HPC codes, with some applications such as life sciences and manufacturing being compute-bound and others such as earth systems, oil and gas, and AI being memory-bound. On the CPU front, growth in memory bandwidth has lagged behind HPC and AI compute performance. Furthermore, workload performance hasn’t kept up with compute—while core count and core enhancements have increased, data hasn’t been efficiently fed to those cores. On the GPU front, there has been too little memory capacity. At the same time, data movement overhead between CPUs and GPUs has resulted in lost performance and wasted energy.</p>
                        <p>Intel Max Series processors were created to address these issues.</p>
                        <p class="mb-0">Starting with CPUs, the <strong>Intel® Xeon® processor Max Series is the first and only x86-based processor with high-bandwidth memory (HBM</strong>), delivering<strong> up to 4.8X better performance</strong> compared to competition on real-world HPC and AI workloads<sup>1</sup>. They feature:</p>
                        <ul> 
                            <li>Up to 56 performance cores constructed of four tiles and connected using Intel’s embedded multi-die interconnect bridge (EMIB) technology.</li> 
                            <li>64GB of ultra-high-bandwidth in-package memory plus support for PCI Express 5.0 and CXL1.1 I/O.</li> 
                            <li>Up to 1.14GB of HBM capacity per core.</li> 
                        </ul>
                        <p class="mb-0">This provides GPU-level memory bandwidth at scale for the majority of HPC codes that run on a CPU. Additionally, these CPUs help you maximize bandwidth to feed data more efficiently to processor cores across three memory modes:</p>
                        <ul> 
                            <li>HBM Only – for workload capacity of 64GB or less</li> 
                            <li>HBM Flat Mode – flat memory regions with HBM and DRAM for workload capacity of 64GB or more</li> 
                            <li>HBM Caching Mode – with DRAM-backed cache for improved performance for workload capacity greater than 64GB</li> 
                        </ul>
                        <p>Moving to GPUs, the <strong>Intel® Data Center GPU Max Series is Intel’s highest performing, highest density</strong>, general-purpose discrete GPU, which packs <strong>over 100 billion transistors</strong> into a package and contains <strong>up to 128 Xe Cores</strong>—Intel’s foundational GPU-compute building block. They feature:</p>
                    </section>
                    <section id="dk_intel_vtune">
                        <p class="mb-0">&nbsp;</p>
                        <h3 style="font-weight: 350;">Intel® VTune™ Profiler: One Tool to Optimize Multiple CPU-GPU Workloads</h3>
                        <p><a class="b_special_a1" href="">Intel VTune Profiler</a> is a powerful performance analysis tool to identify issues that slow down the code running on CPU, GPU, or FPGA, enabling developers to focus their tuning effort and get the best performance gain in the least amount of time.</p>
                    </section>
                    <section id="dk_will_your">
                        <p class="mb-0">&nbsp;</p>
                        <h4 style="font-weight: 400;">Will Your Workload Benefit from HBM?</h4>
                        <p>You can use VTune Profiler to identify which memory mode offers the best performance utilizing HBM on the Intel Xeon processor Max Series. Profile your workload for each mode: HBM, flat, or cache.</p>
                        <p class="mb-0">To evaluate the benefits of HBM, the following analysis types can be used:</p>
                        <ul> 
                            <li><a class="b_special_a1" href="">Memory Access</a> analysis</li> 
                            <li><a class="b_special_a1" href="">Microarchitecture Exploration</a> analysis with the <strong>Analyze memory bandwidth</strong> option enabled</li> 
                            <li><a class="b_special_a1" href="">HPC Performance Characterization</a> analysis with the <strong>Analyze memory bandwidth</strong> option enabled</li> 
                        </ul>
                        <p>VTune Profiler includes HBM-specific performance metrics that can help understand the usage of HBM memory by the workload. The workload performance can be analyzed in the context of HBM memory by reviewing the following viewpoints:</p>
                    </section>
                    <section id="dk_bandwidth">
                        <p class="mb-0">&nbsp;</p>
                        <h4 style="font-weight: 400;">Bandwidth Utilization Histogram</h3>
                        <p>The <strong>bandwidth utilization</strong> section of the <strong>Summary </strong>window is updated to include two HBM-specific metrics: “<strong>HBM, GB/sec</strong>” and “<strong>HBM Single-Package, GB/sec</strong>” (<strong>Figure 1</strong>). These domains show data like the DRAM bandwidth domain but in the context of HBM.</p>
                        <p>The bandwidth utilization histogram helps to understand the HBM memory utilization in the Low, Medium, and High utilization categories.</p>
                        <p><strong>Single-Package</strong> domains are displayed for the systems with more than two CPU packages and the histogram for them shows the distribution of the elapsed time per maximum bandwidth utilization <em>among all packages</em>. Use this data to identify situations where your application utilizes bandwidth only on a subset of CPU packages. In this case, the whole system bandwidth utilization represented by domains like DRAM may be low, whereas the performance is in fact limited by bandwidth utilization. You can switch to <strong>Bottom-up </strong>window and group the grid data by <strong>../Bandwidth Utilization Type/.. </strong>and identify functions or memory objects with high bandwidth utilization in the specific bandwidth domain.</p>
                        <p style="text-align:center"><img class="w-100" alt="" height="" src="/img/darshit_image/f1-vtune-bandwidth-distribution.png" width="820"></p>
                        <p class="utility-text-1" style="text-align:center"><strong>Figure 1. How is bandwidth distributed</strong></p>
                    </section>
                    <section id="dk_timeline_pane">
                        <p>&nbsp;</p>
                        <h4 style="font-weight: 400;">Timeline Pane</h4>
                        <p>To identify bandwidth issues in your workload over time, focus on the <a class="b_special_a1" href="">Timeline pane</a> provided at the top of the <strong>Bottom-up</strong> window (<strong>Figure 2</strong>). The timeline pane includes the overtime view of the HBM bandwidth split by CPU packages. The view includes HBM Read/Write Bandwidth and HBM Bandwidth (total) graphs. You may focus on analyzing specific parts of the bandwidth graph by selecting the region or filter the graphs using the HBM Bandwidth checkboxes on the right side.</p>
                        <p style="text-align:center"><img class="w-100" alt="" height="" src="/img/darshit_image/f2-vtune-cpu-performance-hbm-modes.png" width="804"></p>
                        <p class="utility-text-1" style="text-align:center"><strong>Figure 2. The workload performance in various HBM modes can be evaluated by running the collection in each mode and analyzing the bandwidth as described above.</strong></p>
                    </section>
                    <section id="dk_how_do_we">
                        <p class="mb-0">&nbsp;</p>
                        <h4 style="font-weight: 400;">How Do We Ensure Optimal Data Traffic between CPU and GPU?</h4>
                        <p>You can also use Intel VTune Profiler for visibility into Xe Link cross-card traffic on the Intel Data Center GPU Max Series for issues such as stack-to-stack traffic, throughput, and bandwidth bottlenecks. It helps identify imbalances of traffic between CPU and GPU through a GPU topology diagram.</p>
                        <p class="mb-0">To evaluate the benefits of Xe Link cross-card interconnect, the following analysis types can be used:</p>
                        <ul> 
                            <li>GPU Offload with the <strong>Analyze Xe Link usage</strong> option enabled.</li> 
                            <li>GPU Compute/Media Hotspots with the <strong>Analyze Xe Link usage</strong> option enabled.</li> 
                        </ul>
                        <p>Intel VTune Profiler includes Xe Link traffic and bandwidth observability that can help understand cross-card memory transfers and Xe Link utilization by the workload. Grid with overall card-to-card traffic and bandwidth by Xe Link can be found on Summary view of result.</p>
                        <p style="text-align:center"><img class="w-100" alt="" height="" src="/img/darshit_image/f3-vtune-gpu-xe-link-usage.png" width="600"></p>
                        <p>Also, cross-card, stack-to-stack and card-to-socket bandwidth are presented on <strong>GPU Topology Diagram</strong> on Summary. It can help to understand GPU topology of the system and estimate communication bandwidth of exact link, stack, or card by selection of part with hovering.</p>
                        <p style="text-align:center"><img class="w-100" alt="" height="" src="/img/darshit_image/f4-vtune-gpu-topology-diagram.png" width="600"></p>
                        <p>For deeper analysis of cross-card memory transfers users can use timeline on platform panel. With bandwidth over time can see usage of Xe Link by different phases of workload, reaching maximums and correlate it with code execution.</p>
                        <p style="text-align:center"><img class="w-100" alt="" height="" src="/img/darshit_image/f5-vtune-gpu-offload.png" width="600"></p>
                        <p>To get started, <a class="b_special_a1" href="">download Intel VTune Profiler</a> and get the <a class="b_special_a1" href="">code samples</a>.</p>
                    </section>
                </div>
            </div>
        </div>
    </section>

     <section style="border-top: 1px solid #d7d7d7;" class="container py-5">
        <h4 class="h6">Product and Performance Information</h4>
        <div class="disclaimer" style="font-size: 12px;"><sup>1</sup> Visit the SuperComputing '22 page at <a class="b_special_a1" href=""> Performance Index site</a> for workloads and configurations. Performance varies by use, configuration and other factors. See backup configuration for details. No product or component can be absolutely secure.</div>
        <div class="disclaimer" style="font-size: 12px;"><sup>2</sup> Performance varies by use, configuration and other factors. Learn more at <a class="b_special_a1" href=""> www.Intel.com/PerformanceIndex</a>.</div>
    </section>

    <!-- footer -->
    <div id="footer"></div>

    <!-- script header and footer -->
    <script>
        // navbar include  
        fetch('/y_index/y_navbar.html')
            .then(response => response.text())
            .then(data => {
                document.getElementById('navbar').innerHTML = data;
            });
        // footer include 
        fetch('/y_index/y_footer.html')
            .then(response => response.text())
            .then(data => {
                document.getElementById('footer').innerHTML = data;
            });
    </script>

    <!-- nav script -->
    <script>
        document.addEventListener('DOMContentLoaded', function () {
        if (document.getElementsByClassName('VK_all_sections section') && document.getElementsByClassName('VK_sidebar_dropdown')) {
            const sections = document.querySelectorAll('.VK_all_sections section');
            const navLinks = document.querySelectorAll('.VK_sidebar_dropdown a');
            const detailsElements = document.querySelectorAll('.VK_sidebar_dropdown details');

            function removeActiveClass() {
                navLinks.forEach(link => link.classList.remove('VK_sidebar_active_link'));
                detailsElements.forEach(details => {
                    details.removeAttribute('open');
                    details.setAttribute('close', ''); // Optional: to visually indicate it's closed
                });
            }

            function activateLinkAndDetails(targetId) {
                navLinks.forEach(link => {
                    if (link.getAttribute('href') === `#${targetId}`) {
                        link.classList.add('VK_sidebar_active_link');
                        let parentDetails = link.closest('details');

                        // Open all ancestor details elements
                        while (parentDetails) {
                            parentDetails.setAttribute('open', '');
                            parentDetails.removeAttribute('close'); // Optional: remove the closed indicator
                            parentDetails = parentDetails.parentElement.closest('details');
                        }
                    }
                });
            }

            function onScroll() {
                let currentSection = '';
                sections.forEach(section => {
                    const sectionTop = section.getBoundingClientRect().top;
                    const sectionBottom = section.getBoundingClientRect().bottom;

                    // Check if the section is in view
                    if (sectionTop <= 100 && sectionBottom >= 0) {
                        currentSection = section.getAttribute('id');
                    }
                });

                if (currentSection) {
                    removeActiveClass();
                    activateLinkAndDetails(currentSection);
                } else {
                    removeActiveClass();
                }
            }

            window.addEventListener('scroll', onScroll);
        } else {
            return
        }
    });
    </script>

    <!-- copy script -->
    <script>
        document.addEventListener("DOMContentLoaded", () => {
            document.querySelectorAll(".mv_copy_icon").forEach((icon) => {
                icon.addEventListener("click", async function () {
                    try {
                        const toolbar = this.closest(".mv_code_toolbar");
                        const codeBlock = toolbar.querySelector(".code-content");
                        const codeContent = codeBlock.innerText;
    
                        // Use Clipboard API to copy text
                        await navigator.clipboard.writeText(codeContent);
    
                        // Hide the copy icon and show the "Copied!" message
                        const message = toolbar.querySelector(".mv_copy_message");
                        this.classList.add("hidden"); // Hide the copy icon
                        message.classList.remove("hidden"); // Show the "Copied!" message
    
                        // Hide the message and show the icon again after 2 seconds
                        setTimeout(() => {
                            message.classList.add("hidden");
                            this.classList.remove("hidden");
                        }, 2000); // Adjust delay as needed
    
                    } catch (err) {
                        console.error('Failed to copy text: ', err);
                    }
                });
            });
        });
    </script>

</body>

</html>

